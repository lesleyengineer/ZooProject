ME3=function(){var _this=this;_this.config={},_this.els={body:null,container:null,tabs:null,tabsAnchors:null,slides:null,slidesMedia:null,slidesMediaUL:null,slidesMediaULLIs:null,slidesControls:null,slidesControlPrevious:null,slidesControlNext:null,slidesCC:null,slidesCounter:null,slidesCounterCurrent:null,slidesCounterTotal:null,slidesTimeline:null,slidesTimelineBars:null,controls:null,controls360:null,controls360PanLeft:null,controls360PanUp:null,controls360PanRight:null,controls360PanDown:null,controls360ZoomIn:null,controls360ZoomOut:null,controlsVideo:null,controlsVideoProgressBar:null,controlsVideoPlayPause:null,controlsVideoTimer:null,controlsVideoVolume:null,controlsVideoVolumeMute:null,controlsVideoVolumeLevels:null,controlsVideoCC:null,controlsVideoDT:null,controlsGeneral:null,controlsGeneralSlideshowPlayPause:null,controlsGeneralShare:null,controlsGeneralShareToggle:null,controlsGeneralShareLinks:null,controlsGeneralShareLinksLIs:null,controlsGeneralFullscreen:null,thumbnails:null,thumbnailsControls:null,thumbnailsControlPrevious:null,thumbnailsControlNext:null,thumbnailsUL:null,thumbnailsULLIs:null,countdown:null,recommendations:null,fullscreenExit:null,exitGav:null},_this.state={accessibility:{firstTabbableEl:null,lastTabbableEl:null},analytics:{frameworkLoaded:!1,frameworkLoadAttempts:0,pageModel:null,trackAttempts:0},cc:!1,countdown:null,currentMediaIndex:0,currentMediaSetIndex:0,currentMediaSetMedia:null,currentMediaSetMediaItem:null,currentMediaSetTotalMedia:0,currentMediaSet:[],currentMediaType:"",currentMediaEl:null,currentMediaElVideo:null,currentMediaElVideoPlayPauseOverlay:null,currentMediaElVideoEndOverlay:null,currentMediaElYouTube:null,currentTimelineBar:null,currentYouTubePlayer:null,currentYouTubePlayerTimeUpdateId:null,currentMediaElYouTubePlayPauseOverlay:null,currentTabIndex:null,currentThumbnailPage:0,fullscreen:!1,fullscreenEntering:!1,fullscreenExiting:!1,fullscreenAPISupported:!1,idleTimeId:null,recommendationsIdleTimeId:null,ie10Or11:!!window.MSInputMethodContext&&!!document.documentMode||-1!==navigator.appVersion.indexOf("MSIE 10"),ios:!1,inputOrChange:"input",language:"en",mediaSets:[],previousMediaIndex:0,previousMediaSetIndex:0,ready:!1,recommendations:[],clickedRecommendation:{},seenRecommendation:[],resizeId:null,slideshowPlaying:!1,slideshowId:!1,tabNameMediaSetMap:{},tapToggle:!1,theme:"",thumbnailImagesLoadedCounter:0,threeSixty:{camera:null,clientX:0,clientY:0,contextHelper:null,distance:50,dragStartX:0,dragStartY:0,far:1e3,fov:10,geometry:null,lat:0,lon:0,material:null,materialAndDataUriMap:{material:{},dataUri:{}},mediaAspect:0,mediaEl:null,mediaHeight:0,mesh:null,mouseDown:!1,mouseDownLat:0,mouseDownLon:0,near:1,phi:0,renderer:null,requestAnimationId:null,requestPanningId:null,resolutionHeight:1080,resolutionWidth:1920,scene:null,scriptLoaded:!1,texture:null,theta:0,time:(new Date).getTime(),zoom:75,zoomMax:35},touch:{supported:!1,slides:{preDragLeft:0,startX:0,startY:0,moveX:0,moveY:0,endX:0,endY:0}},touchOrClick:"",totalMedia:0,totalThumbnailPages:0,thumbnailsMaxVisible:null,thumbnailsEnabled:!0,thumbnailsWidth:0,thumbnailWidth:0,videoVolumeLevel:1,videoVolumeMuted:!1,width:0,height:0,youTubeAPIScriptLoaded:!1,youTubePlayers:{}},_this.init=function(elSelector,config){window.addEventListener("load",function(){console.log("All images loaded.")}),_this.els.body=document.body,_this.els.container=document.querySelectorAll(elSelector)[0],_this.state.theme=window.getComputedStyle(_this.els.container,":after").getPropertyValue("content").replace(/"/g,""),_this.state.ready=!0,_this.els.container.classList.add("me-theme-"+_this.state.theme),_this.loadConfig(config),_this.platformSetup(),_this.dialupSendData()},_this.getDialupConfig=function(){return new Promise(function(resolve,reject){window.location.href.indexOf("stage")>0&&-1===window.location.href.indexOf("dsprings")&&-1===window.location.href.indexOf("disneysprings")?fetch("https://stage.cdn1.parksmedia.wdprapps.disney.com/media/flashComponents/mediaEngine/data/dialup-config.json").then(function(resp){resolve(resp.json())}).catch(function(){console.log("couldn't fetch dialup config"),_this.theRestOfInit()}):window.location.href.indexOf("disneyworld")>0&&-1===window.location.href.indexOf("dsprings")&&-1===window.location.href.indexOf("disneysprings")?fetch("https://cdn1.parksmedia.wdprapps.disney.com/media/flashComponents/mediaEngine/data/dialup-config.json").then(function(resp){resolve(resp.json())}).catch(function(){console.log("couldn't fetch dialup config"),_this.theRestOfInit()}):_this.theRestOfInit()})},_this.dialupSendData=function(){_this.getDialupConfig().then(function(json){_this.dialupInit(json),_this.theRestOfInit()})},_this.theRestOfInit=function(){!0===_this.config.recommendations&&"recommendations"!==_this.config.media[_this.config.media.length-1].type&&_this.config.media.push({type:"recommendations",thumbnail:"https://digital-media-stage-usw2.s3-us-west-2.amazonaws.com/media/media-engine/3.0.0/sample-media/mickey-recommendations.png",source:"https://digital-media-stage-usw2.s3-us-west-2.amazonaws.com/media/media-engine/3.0.0/sample-media/mickey-recommendations.png",title:"Recommendations",tags:["All"],alt:"Recommendations"}),_this.parseMedia(),_this.loadMediaSet(_this.config.tabs.initial),_this.buildHTML(),_this.bindEventListeners(!0),_this.analyticsInit(),_this.slideshowInit(),_this.videoVolumeInit(),_this.loadSlide(0),_this.highlightActiveTab(),_this.accessibilityInit(),_this.bindAccessibilityEventListeners(),_this.idleTimerSet(),_this.hotLinkInit(),_this.muteSafari(),window.setTimeout(function(){_this.config.callbacks.ready&&(_this.config.callbacks.ready(),_this.els.container.dispatchEvent(new Event("me-ready",{bubbles:!0})))},0),!0===_this.config.recommendations&&_this.config.defaultRecommendations&&_this.recommend(_this.config.defaultRecommendations)},_this.dialupInit=function(json){if(ME3.prototype.utilities.storage.localStorageIsSupported()){const url=window.location.href,words=json.dial_page_types,languages=json.languages;for(var i=0;i<words.length;i++){var replace=words[i],regex=new RegExp("/"+replace+"/","i");if(url.match(regex)&&"en-us"===languages[0]){url.match(/\/es-us\/|\/en_CA\/|\/fr-ca\/|\/es-ar\/|\/es-mx\/|\/jp\/|\/es-pe\/|\/es-co\/|\/es-cl\/|\/pt-br\//)||_this.dialupRecommendationsLogic(json);break}}}},_this.dialupRecommendationsLogic=function(json){json.dialupPercentage<=1&&(null===localStorage.getItem("recsDialup")&&localStorage.setItem("recsDialup",""),dialupStorageItem=localStorage.getItem("recsDialup"),dialupPercentage=json.dialupPercentage?parseFloat(json.dialupPercentage):0,currentPhase=json.currentPhase,groupShow="-sawRecommendations",groupNoShow="-didNotSeeRecommendations",0===dialupPercentage?localStorage.setItem("recsDialup",currentPhase+groupNoShow):1===dialupPercentage?localStorage.setItem("recsDialup",currentPhase+groupShow):dialupStorageItem.includes(groupShow)||dialupStorageItem==currentPhase+groupNoShow||(Math.random()<=dialupPercentage?localStorage.setItem("recsDialup",currentPhase+groupShow):localStorage.setItem("recsDialup",currentPhase+groupNoShow)),dialupStorageItem.includes(groupShow)&&(_this.config.recommendations=!0,_this.config.defaultRecommendations=[{name:"Under the Sea ~ Journey of The Little Mermaid",img:"https://secure.cdn1.wdpromedia.com/resize/mwImage/1/410/205/75/dam/wdpro-assets/parks-and-tickets/attractions/magic-kingdom/under-the-sea-journey-of-the-little-mermaid/under-the-sea-journey-of-the-little-mermaid-new-00.jpg?1524779101354",lid:"Recommendation_Click_Pos1",themePark:"Magic Kingdom Park",url:"/attractions/magic-kingdom/under-the-sea-journey-of-the-little-mermaid/#int_cmp=ILC-Rec-Pos1"},{name:"Frontierland Shootin&#39; Arcade",img:"https://secure.cdn1.wdpromedia.com/resize/mwImage/1/410/205/75/dam/wdpro-assets/parks-and-tickets/attractions/magic-kingdom/frontierland-shootin-arcade/frontierland-shootin-arcade-00.jpg?1520710267476",lid:"Recommendation_Click_Pos2",themePark:"Magic Kingdom Park",url:"/attractions/magic-kingdom/frontierland-shootin-arcade/#int_cmp=ILC-Rec-Pos2"},{name:"Big Thunder Mountain Railroad",img:"https://secure.cdn1.wdpromedia.com/resize/mwImage/1/410/205/75/dam/wdpro-assets/parks-and-tickets/attractions/magic-kingdom/big-thunder-mountain-railroad/big-thunder-mountain-railroad-00.jpg?1523286871423",lid:"Recommendation_Click_Pos3",themePark:"Magic Kingdom Park",url:"/attractions/magic-kingdom/big-thunder-mountain-railroad/#int_cmp=ILC-Rec-Pos3"}]),_this.analyticsTrack("recommendationShowOrNo"))},_this.muteSafari=function(){var ua=navigator.userAgent.toLowerCase();ua.indexOf("safari")&&-1===ua.indexOf("chrome")&&localStorage&&localStorage.setItem("ME_volume_mute","true")},_this.idleTimerSet=function(){_this.state.idleTimeId=window.setTimeout(_this.idleClassSet,_this.config.idleTime)},_this.idleTimerReset=function(){_this.idleClassUnset(),window.clearTimeout(_this.state.idleTimeId),_this.idleTimerSet()},_this.idleClassSet=function(){_this.els.container.classList.add("me-idle")},_this.idleClassUnset=function(){_this.els.container.classList.remove("me-idle")},_this.init360=function(){_this.state.threeSixty.scriptLoaded?_this.create360SceneInit(_this.state.currentMediaType):_this.load360Plugin()},_this.load360Plugin=function(){var threeSixtyScript=document.createElement("script");threeSixtyScript.src="./js/vendor/three.min.js",threeSixtyScript.crossorigin="anonymous",threeSixtyScript.onload=function(){_this.state.threeSixty.scriptLoaded=!0,_this.create360SceneInit(_this.state.currentMediaType)},_this.els.body.appendChild(threeSixtyScript)},_this.create360SceneInit=function(mediaType){_this.state.currentMediaEl.querySelector("canvas")&&_this.state.currentMediaEl.removeChild(_this.state.currentMediaEl.querySelector("canvas")),window.setTimeout(function(){_this.reset360(),_this.create360Scene(mediaType)},500)},_this.create360Scene=function(mediaType){_this.state.threeSixty.lon=0,_this.state.threeSixty.lat=0,_this.state.threeSixty.mediaEl=_this.state.currentMediaEl.querySelector("img, video"),_this.state.threeSixty.mediaEl.classList.remove("me-hide"),_this.state.threeSixty.mediaHeight=parseInt(window.getComputedStyle(_this.state.threeSixty.mediaEl).height),_this.state.threeSixty.mediaAspect=_this.state.width/_this.state.threeSixty.mediaHeight,_this.state.threeSixty.mediaEl.classList.add("me-hide"),_this.state.threeSixty.camera=new THREE.PerspectiveCamera(_this.state.threeSixty.fov,_this.state.threeSixty.aspect,_this.state.threeSixty.near,_this.state.threeSixty.far),_this.state.threeSixty.camera.target=new THREE.Vector3(0,0,0),_this.state.threeSixty.camera.setLens(_this.state.threeSixty.fov),_this.state.threeSixty.scene=new THREE.Scene,_this.state.threeSixty.geometry=new THREE.SphereBufferGeometry(500,60,40),_this.state.threeSixty.geometry.scale(-1,1,1),"video-360"===mediaType?_this.state.threeSixty.texture=new THREE.VideoTexture(_this.state.threeSixty.mediaEl):"image-360"===mediaType&&(_this.state.threeSixty.texture=(new THREE.TextureLoader).load(_this.state.threeSixty.mediaEl.src)),_this.state.threeSixty.texture.minFilter=THREE.LinearFilter,_this.state.threeSixty.texture.format=THREE.RGBFormat,_this.state.threeSixty.material=new THREE.MeshBasicMaterial({map:_this.state.threeSixty.texture}),_this.state.threeSixty.mesh=new THREE.Mesh(_this.state.threeSixty.geometry,_this.state.threeSixty.material),_this.state.threeSixty.scene.add(_this.state.threeSixty.mesh),_this.state.threeSixty.renderer=new THREE.WebGLRenderer,_this.state.threeSixty.renderer.setPixelRatio(window.devicePixelRatio),_this.state.threeSixty.renderer.setSize(_this.state.width,_this.state.threeSixty.mediaHeight),_this.state.currentMediaEl.insertBefore(_this.state.threeSixty.renderer.domElement,_this.state.currentMediaEl.childNodes[1]),_this.animate360(),_this.bind360EventListeners()},_this.bind360EventListeners=function(){var canvas=_this.state.threeSixty.renderer.domElement;canvas.addEventListener("mousedown",function(e){_this.state.threeSixty.mouseDown=!0,_this.state.threeSixty.dragStartX=e.clientX,_this.state.threeSixty.dragStartY=e.clientY,_this.state.threeSixty.mouseDownLon=_this.state.threeSixty.lon,_this.state.threeSixty.mouseDownLat=_this.state.threeSixty.lat}),canvas.addEventListener("mousemove",function(e){_this.state.threeSixty.clientX=e.clientX,_this.state.threeSixty.clientY=e.clientY,_this.state.threeSixty.mouseDown&&!_this.state.threeSixty.requestPanningId&&_this.panning360()}),canvas.addEventListener("mouseup",function(e){_this.state.threeSixty.mouseDown=!1,cancelAnimationFrame(_this.state.threeSixty.requestPanningId),_this.state.threeSixty.requestPanningId=null}),canvas.addEventListener("mouseleave",function(e){_this.state.threeSixty.mouseDown=!1,cancelAnimationFrame(_this.state.threeSixty.requestPanningId),_this.state.threeSixty.requestPanningId=null})},_this.panning360=function(direction){_this.state.threeSixty.requestPanningId=window.requestAnimationFrame(_this.panning360.bind(this)),_this.state.threeSixty.lon=.2*(_this.state.threeSixty.dragStartX-_this.state.threeSixty.clientX)+_this.state.threeSixty.mouseDownLon,_this.state.threeSixty.lat=.2*(_this.state.threeSixty.dragStartY-_this.state.threeSixty.clientY)+_this.state.threeSixty.mouseDownLat},_this.animate360=function(){_this.state.threeSixty.requestAnimationId=window.requestAnimationFrame(_this.animate360),_this.update360()},_this.update360=function(){"video-360"!==_this.state.currentMediaType&&"image-360"!==_this.state.currentMediaType?window.cancelAnimationFrame(_this.state.threeSixty.requestPanningId):_this.state.threeSixty.camera&&_this.state.threeSixty.renderer&&(_this.state.threeSixty.lat=Math.max(-85,Math.min(85,_this.state.threeSixty.lat)),_this.state.threeSixty.phi=THREE.Math.degToRad(90-_this.state.threeSixty.lat),_this.state.threeSixty.theta=THREE.Math.degToRad(_this.state.threeSixty.lon),_this.state.threeSixty.camera.position.x=_this.state.threeSixty.distance*Math.sin(_this.state.threeSixty.phi)*Math.cos(_this.state.threeSixty.theta),_this.state.threeSixty.camera.position.y=_this.state.threeSixty.distance*Math.cos(_this.state.threeSixty.phi),_this.state.threeSixty.camera.position.z=_this.state.threeSixty.distance*Math.sin(_this.state.threeSixty.phi)*Math.sin(_this.state.threeSixty.theta),_this.state.threeSixty.camera.lookAt(_this.state.threeSixty.camera.target),_this.state.threeSixty.renderer.render(_this.state.threeSixty.scene,_this.state.threeSixty.camera))},_this.reset360=function(){_this.state.threeSixty.scriptLoaded&&(_this.els.slidesMediaULLIs.forEach(function(el,i){el.querySelector("canvas")&&el.removeChild(el.querySelector("canvas"))}),_this.state.threeSixty.camera=null,_this.state.threeSixty.lon=0,_this.state.threeSixty.lat=0,_this.state.threeSixty.mediaHeight=0,_this.state.threeSixty.mediaAspect=0,_this.state.threeSixty.geometry=null,_this.state.threeSixty.material=null,_this.state.threeSixty.mesh=null,_this.state.threeSixty.renderer=null,_this.state.threeSixty.scene=null,_this.state.threeSixty.texture=null,_this.state.threeSixty.requestPanningId&&window.cancelAnimationFrame(_this.state.threeSixty.requestPanningId),_this.state.threeSixty.requestAnimationId&&window.cancelAnimationFrame(_this.state.threeSixty.requestAnimationId))},_this.platformSetup=function(){if(_this.state.touch.supported=/Android|webOS|iPhone|iPad|iPod|iOS|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in window,_this.state.ios=/iPad|iPhone|iPod|iOS/i.test(navigator.userAgent)&&!window.MSStream,_this.state.android=/Android/i.test(navigator.userAgent),_this.state.touch.supported?(_this.state.touchOrClick=_this.state.android?"click":"touchstart",_this.els.container.classList.add("me-touch")):(_this.state.touchOrClick="click",_this.els.container.classList.add("me-no-touch")),_this.config.thumbnails.previewOnHover&&!_this.state.touch.supported&&_this.els.container.classList.add("me-thumbnail-previews"),_this.state.fullscreenAPISupported=document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled,"NodeList"in window&&!NodeList.prototype.forEach&&(console.info("polyfill for IE11"),NodeList.prototype.forEach=function(callback,thisArg){thisArg=thisArg||window;for(var i=0;i<_this.length;i++)callback.call(thisArg,this[i],i,this)}),_this.state.ie10Or11&&"none"!==_this.state.theme){var link=document.createElement("link");link.type="text/css",link.rel="stylesheet",link.href="https://cdn1.parksmedia.wdprapps.disney.com/media/media-engine/3.0.0/css/media-engine.the_this."+_this.state.theme+".css",document.body.appendChild(link)}Math.max(window.screen.width,window.screen.height)<_this.config.thumbnails.minWidth&&(_this.state.thumbnailsEnabled=!1)},_this.loadConfig=function(config){_this.config=ME3.prototype.utilities.extend(ME3.prototype.utilities.extend({},ME3.prototype.defaults),config)},_this.parseMedia=function(){var tabNames=[];_this.state.totalMedia=_this.config.media.length,_this.state.tabNameMediaSetMap.All=[];for(var i=0;i<_this.state.totalMedia;i++){var media=_this.config.media[i];if(!_this.state.touch.supported||"video-360"!==media.type&&"image-360"!==media.type){if(media.tags&&media.tags instanceof Array)for(var j=0;j<media.tags.length;j++){var tabName=media.tags[j];_this.state.tabNameMediaSetMap[tabName]||(_this.state.tabNameMediaSetMap[tabName]=[]),"All"!==tabName&&_this.state.tabNameMediaSetMap[tabName].push(media)}"video"!==media.type&&"video-360"!==media.type&&"cinemagraph"!==media.type||(media.source=_this.getSupportedVideoSource(media.source),media.sourceFullscreen&&(media.sourceFullscreen=_this.getSupportedVideoSource(media.sourceFullscreen)),_this.config.thumbnails.previewOnHover&&(media.preview=media.preview&&media.preview.length?_this.getSupportedVideoSource(media.preview):media.source)),"countdown"===media.type&&(_this.state.countdown={initialized:!1,interval:null,date:media.source,onExpire:media.onExpire}),_this.state.tabNameMediaSetMap.All.push(media)}}(tabNames=Object.keys(_this.state.tabNameMediaSetMap)).sort(_this.config.tabs.sort);for(i=0;i<tabNames.length;i++){tabName=tabNames[i];_this.state.mediaSets.push({tabName:tabName,media:_this.state.tabNameMediaSetMap[tabName]})}_this.state.mediaSets.length<=2&&_this.els.container.classList.add("me-single-media-set")},_this.changeMediaSet=function(mediaSetIndex){_this.destroyYouTubePlayers(),_this.unbindAccessibilityEventListeners(),_this.loadMediaSet(mediaSetIndex),_this.els.slidesMediaUL.innerHTML=_this._buildSlidesULLIs(),_this.els.slidesMediaULLIs=_this.els.container.querySelectorAll(".me-slides-media ul li"),_this.config.slides.timeline&&(_this.els.slidesTimeline.innerHTML=_this._buildTimelineBars(),_this.els.slidesTimelineBars=_this.els.slidesTimeline.querySelectorAll(".me-slides-timeline-bar")),_this.state.thumbnailsEnabled&&(_this.els.thumbnailsUL.innerHTML=_this._buildThumbnailsULLIs(),_this.els.thumbnailsULLIs=_this.els.container.querySelectorAll(".me-thumbnails-media ul li"),_this.state.thumbnailImagesLoadedCounter=0),_this.bindEventListeners(!1),_this.loadSlide(0),_this.state.thumbnailsEnabled&&_this.resetThumbnailControls(),_this.highlightActiveTab(),_this.bindAccessibilityEventListeners(),!0===_this.config.recommendations&&_this.state.currentMediaSetMedia.length&&"recommendations"===_this.state.currentMediaSetMedia[_this.state.currentMediaSetMedia.length-1].type&&(_this.state.recommendations.source?_this.recommend(_this.state.recommendations.source):_this.config.defaultRecommendations&&_this.recommend(_this.config.defaultRecommendations)),_this.state.countdown&&_this.state.countdown.initialized&&(_this.state.countdown.initialized=!1)},_this.loadMediaSet=function(mediaSetIndex){_this.state.previousMediaIndex=_this.state.currentMediaIndex,_this.state.previousMediaSetIndex=_this.state.currentMediaSetIndex,_this.state.currentMediaIndex=0,_this.state.currentMediaSetIndex=mediaSetIndex,_this.state.currentMediaSet=_this.state.mediaSets[_this.state.currentMediaSetIndex],_this.state.currentMediaSetTabName=_this.state.currentMediaSet.tabName,_this.state.currentMediaSetMedia=_this.state.currentMediaSet.media,_this.state.currentMediaSetTotalMedia=_this.state.currentMediaSetMedia.length,1===_this.state.currentMediaSetTotalMedia?_this.els.container.classList.add("me-single-media"):_this.els.container.classList.remove("me-single-media")},_this.buildHTML=function(){for(var html="",i=0;i<_this.config.layout.length;i++)switch(_this.config.layout[i]){case"tabs":html+=_this._buildTabsSectionHTML();break;case"slides":html+=_this._buildSlidesSectionHTML();break;case"controls":html+=_this._buildControlsSectionHTML();break;case"thumbnails":_this.state.thumbnailsEnabled&&(html+=_this._buildThumbnailsSectionHTML())}html='<div class="me-spacing">'+(html+=_this._buildOtherHTML())+"</div>",_this.els.container.innerHTML=html,_this.els.tabs=_this.els.container.querySelector(".me-tabs"),_this.els.tabsAnchors=_this.els.tabs.querySelectorAll(".me-tab"),_this.els.slides=_this.els.container.querySelector(".me-slides"),_this.els.slidesMedia=_this.els.container.querySelector(".me-slides-media"),_this.els.slidesMediaUL=_this.els.container.querySelector(".me-slides-media ul"),_this.els.slidesMediaULLIs=_this.els.container.querySelectorAll(".me-slides-media ul li"),_this.els.slidesControls=_this.els.container.querySelector(".me-slides-controls"),_this.els.slidesControlPrevious=_this.els.slidesControls.querySelector(".me-slides-control-previous"),_this.els.slidesControlNext=_this.els.slidesControls.querySelector(".me-slides-control-next"),_this.els.slidesCC=_this.els.container.querySelector(".me-slides-cc"),_this.els.slidesCounter=_this.els.container.querySelector(".me-slides-counter"),_this.els.slidesCounterCurrent=_this.els.slidesCounter.querySelector(".me-slides-counter-current"),_this.els.slidesCounterTotal=_this.els.slidesCounter.querySelector(".me-slides-counter-total"),_this.config.slides.timeline&&(_this.els.slidesTimeline=_this.els.container.querySelector(".me-slides-timeline"),_this.els.slidesTimelineBars=_this.els.slidesTimeline.querySelectorAll(".me-slides-timeline-bar")),_this.els.controls=_this.els.container.querySelector(".me-controls"),_this.els.controls360=_this.els.controls.querySelector(".me-controls-360"),_this.els.controls360PanLeft=_this.els.controls360.querySelector(".me-360-pan-left"),_this.els.controls360PanUp=_this.els.controls360.querySelector(".me-360-pan-up"),_this.els.controls360PanRight=_this.els.controls360.querySelector(".me-360-pan-right"),_this.els.controls360PanDown=_this.els.controls360.querySelector(".me-360-pan-down"),_this.els.controls360ZoomIn=_this.els.controls360.querySelector(".me-360-zoom-in"),_this.els.controls360ZoomOut=_this.els.controls360.querySelector(".me-360-zoom-out"),_this.els.controlsVideo=_this.els.controls.querySelector(".me-controls-video"),_this.els.controlsVideoProgressBar=_this.els.controlsVideo.querySelector(".me-video-progress-bar"),_this.els.controlsVideoPlayPause=_this.els.controlsVideo.querySelector(".me-video-play-pause"),_this.els.controlsVideoTimer=_this.els.controlsVideo.querySelector(".me-video-timer"),_this.els.controlsVideoVolume=_this.els.controlsVideo.querySelector(".me-video-volume"),_this.els.controlsVideoVolumeMute=_this.els.controlsVideoVolume.querySelector(".me-video-volume-mute"),_this.els.controlsVideoVolumeLevels=_this.els.controlsVideoVolume.querySelectorAll(".me-video-volume-level"),_this.els.controlsVideoCC=_this.els.controlsVideo.querySelector(".me-video-cc"),_this.els.controlsVideoDT=_this.els.controlsVideo.querySelector(".me-video-dt"),_this.els.controlsGeneral=_this.els.container.querySelector(".me-controls-general"),_this.els.controlsGeneralSlideshowPlayPause=_this.els.controlsGeneral.querySelector(".me-slideshow-play-pause"),_this.els.controlsGeneralShare=_this.els.controlsGeneral.querySelector(".me-share"),_this.els.controlsGeneralShare&&(_this.els.controlsGeneralShareToggle=_this.els.controlsGeneralShare.querySelector(".me-share-toggle"),_this.els.controlsGeneralShareLinks=_this.els.controlsGeneralShare.querySelector(".me-share-links"),_this.els.controlsGeneralShareLinksLIs=_this.els.controlsGeneralShareLinks.querySelectorAll("li")),_this.els.controlsGeneralFullscreen=_this.els.controlsGeneral.querySelector(".me-fullscreen"),_this.els.thumbnails=_this.els.container.querySelector(".me-thumbnails-inner"),_this.els.fullscreenExit=_this.els.container.querySelector(".me-fullscreen-exit"),_this.config.thumbnails.controls&&(_this.els.thumbnailsControls=_this.els.container.querySelector(".me-thumbnails-controls"),_this.els.thumbnailsControlPrevious=_this.els.container.querySelector(".me-thumbnails-control-previous"),_this.els.thumbnailsControlNext=_this.els.container.querySelector(".me-thumbnails-control-next")),_this.els.thumbnailsUL=_this.els.container.querySelector(".me-thumbnails ul"),_this.els.thumbnailsULLIs=_this.els.container.querySelectorAll(".me-thumbnails ul li")},_this._buildMediaSlideHTML=function(media){var mediaHTML="";switch(media.type){case"image":mediaHTML='<img class="me-media-image '+_this.getLazyLoadedClasses(media)+'" src="'+(_this.shouldLazyLoad(media)?"":_this._getInitialMediaSrc(media))+'"data-src="'+media.source+'"data-src-fs="'+(media.sourceFullscreen?media.sourceFullscreen:"")+'"alt="'+media.alt+'">'+(_this.state.currentMediaSetTotalMedia>1?'<div class="me-image-next-overlay"></div>':""),media.title&&(mediaHTML+='<figcaption class="me-slide-title">'+media.title+"</figcaption>");break;case"image-360":mediaHTML='<img class="me-media-image me-360-src '+_this.getLazyLoadedClasses(media)+'" src="'+(_this.shouldLazyLoad(media)?"":_this._getInitialMediaSrc(media))+'"data-src="'+media.source+'"data-src-fs="'+(media.sourceFullscreen?media.sourceFullscreen:"")+'"crossorigin="anonymous" alt="'+media.alt+'">'+(_this.state.currentMediaSetTotalMedia>1?'<div class="me-image-next-overlay"></div>':""),media.title&&(mediaHTML+='<figcaption class="me-slide-title">'+media.title+"</figcaption>");break;case"video":mediaHTML='<video class="me-media-video no-media-autotrack '+_this.getLazyLoadedClasses(media)+'" src="'+(_this.shouldLazyLoad(media)?"":_this._getInitialMediaSrc(media))+'"data-src="'+media.source+'"data-src-fs="'+(media.sourceFullscreen?media.sourceFullscreen:"")+'"playsinline tabindex="-1" alt="'+media.alt+'" aria-label="'+media.alt+'" '+(media.poster?' poster="'+media.poster+'"':"")+'></video><button class="me-video-play-pause-overlay" role="presentation" aria-label="'+_this.config.accessibility.labels[_this.state.language].controlsVideoPlayPause+'"><span class="me-video-play-pause"></span></button><div class="me-video-end-overlay me-hide"><div class="me-video-end-ctas"><button class="me-video-replay me-btn">Replay</button>'+(media.afterVideoCTAs?_this._buildAfterVideoCTAs():"")+"</div></div>",media.title&&(mediaHTML+='<figcaption class="me-slide-title">'+media.title+"</figcaption>");break;case"video-360":mediaHTML='<video class="me-media-video me-360-src no-media-autotrack '+_this.getLazyLoadedClasses(media)+'" src="'+(_this.shouldLazyLoad(media)?"":_this._getInitialMediaSrc(media))+'"data-src="'+media.source+'"data-src-fs="'+(media.sourceFullscreen?media.sourceFullscreen:"")+'"crossorigin="anonymous" playsinline tabindex="-1" alt="'+media.alt+'" aria-label="'+media.alt+'" '+(media.poster?' poster="'+media.poster+'"':"")+'></video><button class="me-video-play-pause-overlay" role="presentation" aria-label="'+_this.config.accessibility.labels[_this.state.language].controlsVideoPlayPause+'"><span class="me-video-play-pause"></span></button><div class="me-video-end-overlay me-hide"><div class="me-video-end-ctas"><button class="me-video-replay me-btn">Replay</button>'+(media.afterVideoCTAs?_this._buildAfterVideoCTAs():"")+"</div></div>",media.title&&(mediaHTML+='<figcaption class="me-slide-title">'+media.title+"</figcaption>");break;case"youtube":mediaHTML='<div class="me-media-youtube" id="me-media-youtube-'+media.source+'"></div><button class="me-youtube-play-pause-overlay" role="presentation" aria-label="'+_this.config.accessibility.labels[_this.state.language].controlsVideoPlayPause+'"><span class="me-youtube-play-pause"></span></button>',media.title&&(mediaHTML+='<figcaption class="me-slide-title">'+media.title+"</figcaption>");break;case"cinemagraph":mediaHTML='<video class="me-media-cinemagraph no-media-autotrack '+_this.getLazyLoadedClasses(media)+'" src="'+(_this.shouldLazyLoad(media)?"":_this._getInitialMediaSrc(media))+'"data-src="'+media.source+'"data-src-fs="'+(media.sourceFullscreen?media.sourceFullscreen:"")+'"autoplay loop muted playsinline tabindex="-1" alt="'+media.alt+'" aria-label="'+media.alt+'" '+(media.poster?' poster="'+media.poster+'"':"")+"></video>"+(_this.state.currentMediaSetTotalMedia>1?'<div class="me-cinemagraph-next-overlay"></div>':""),media.title&&(mediaHTML+='<figcaption class="me-slide-title">'+media.title+"</figcaption>");break;case"recommendations":mediaHTML=_this._buildRecommendations();break;case"countdown":mediaHTML='<div class="me-media-countdown"><h1 class="time-heading">'+media.title+'</h1><section class="time-blocks"><section class="time-block"><p class="days"></p><p class="label">Days</p></section><section class="time-block"><p class="hours"></p><p class="label">Hours</p></section><section class="time-block"><p class="minutes"></p><p class="label">Minutes</p></section><section class="time-block"><p class="seconds"></p><p class="label">Seconds</p></section></section><section class="time-expired me-hide">'+media.expire+"</section></div>";break;case"html":mediaHTML='<div class="me-media-html">'+media.source+"</div>"}return mediaHTML},_this._getInitialMediaSrc=function(media){return(_this.state.fullscreen||_this.state.fullscreenEntering)&&media.sourceFullscreen?media.sourceFullscreen:media.source},_this._buildMediaThumbnailHTML=function(media){return'<button class="me-btn" data-type="'+media.type+'"><img src="'+(media.thumbnail?media.thumbnail:media.source)+'" alt="'+media.alt+'">'+(!_this.config.thumbnails.previewOnHover||_this.state.touch.supported||"video"!==media.type&&"cinemagraph"!==media.type||!media.preview?"":'<video class="me-video-preview no-media-autotrack" src="'+media.preview+'" loop muted playsinline preload="none" tabindex="-1"></video>')+"</button>"},_this._buildTabsSectionHTML=function(){var tabs=_this._buildTabs();return(_this.config.tabs.customHTML.before?_this.injectCustomHTML(_this.config.tabs.customHTML.before,"tabs","before"):"")+'<section class="me-tabs" role="tablist">'+(_this.config.tabs.customHTML.prepend?_this.injectCustomHTML(_this.config.tabs.customHTML.prepend,"tabs","prepend"):"")+tabs+(_this.config.tabs.customHTML.append?_this.injectCustomHTML(_this.config.tabs.customHTML.append,"tabs","append"):"")+"</section>"+(_this.config.tabs.customHTML.after?_this.injectCustomHTML(_this.config.tabs.customHTML.after,"tabs","after"):"")},_this._buildTabs=function(){for(var tabs="",i=0;i<_this.state.mediaSets.length;i++){var currentMediaSet=_this.state.mediaSets[i],tabName=currentMediaSet.tabName,tabTotal=currentMediaSet.media.length,tabActive=_this.config.tabs.initial===i;_this.config.tabs.showTotals&&(tabName+=" ("+tabTotal+")"),tabs+='<button class="me-tab me-btn'+(tabActive?" me-active":"")+'" data-tab-index="'+i+'" role="tab" aria-selected="'+(tabActive?"true":"false")+'">'+tabName+"</button>"}return tabs},_this._buildSlidesSectionHTML=function(){var slidesULLIs=_this._buildSlidesULLIs();return(_this.config.slides.customHTML.before?_this.injectCustomHTML(_this.config.slides.customHTML.before,"slides","before"):"")+'<section class="me-slides" role="tabpanel" aria-expanded="true">'+(_this.config.slides.customHTML.prepend?_this.injectCustomHTML(_this.config.slides.customHTML.prepend,"slides","prepend"):"")+'<div class="me-slides-preloader"></div><div class="me-slides-controls"><button class="me-slides-control-previous me-btn"></button><button class="me-slides-control-next me-btn"></button></div><p class="me-slides-cc me-hide"></p><p class="me-slides-counter"><span class="me-slides-counter-current"></span>/<span class="me-slides-counter-total"></span></p><div class="me-slides-media"><ul role="presentation" style="transition-duration: '+_this.config.slides.transitionTime+'ms;">'+slidesULLIs+"</ul></div>"+(_this.config.slides.timeline?_this._buildTimelineSectionHTML():"")+(_this.config.slides.customHTML.append?_this.injectCustomHTML(_this.config.slides.customHTML.append,"slides","append"):"")+"</section>"+(_this.config.slides.customHTML.after?_this.injectCustomHTML(_this.config.slides.customHTML.after,"slides","after"):"")},_this._buildTimelineSectionHTML=function(){return'<div class="me-slides-timeline">'+_this._buildTimelineBars()+"</div>"},_this._buildTimelineBars=function(){for(var html="",mediaLength=_this.state.currentMediaSetTotalMedia,i=0;i<mediaLength;i++)html+='<button class="me-slides-timeline-bar me-btn" data-bar="'+i+'"><span class="me-slides-timeline-bar-fill"></span></button>';return html},_this._updateTimelineBars=function(){var currentMediaIndex=_this.state.currentMediaIndex,nonVideoTransitionDuration=_this.config.slides.displayTime+"ms";_this.els.slidesTimelineBars.forEach(function(el,i){var transitionDuration,width;el.querySelector(".me-slides-timeline-bar-fill").style.transitionDuration="0ms",el.querySelector(".me-slides-timeline-bar-fill").style.width="0",i<currentMediaIndex?(transitionDuration="0ms",width="100%"):i===currentMediaIndex&&"video"!==_this.state.currentMediaType&&"video-360"!==_this.state.currentMediaType&&"youtube"!==_this.state.currentMediaType?(transitionDuration=nonVideoTransitionDuration,width="100%"):(transitionDuration="0ms",width="0"),window.setTimeout(function(){el.querySelector(".me-slides-timeline-bar-fill").style.transitionDuration=transitionDuration,el.querySelector(".me-slides-timeline-bar-fill").style.width=width},0)})},_this._buildSlidesULLIs=function(){for(var slidesULLIs="",i=0;i<_this.state.currentMediaSetTotalMedia;i++){var media=_this.state.currentMediaSetMedia[i];media.source&&(slidesULLIs+='<li data-media-index="'+i+'" role="figure">'+_this._buildMediaSlideHTML(media)+"</li>")}return slidesULLIs},_this._buildControlsSectionHTML=function(){return(_this.config.controls.customHTML.before?_this.injectCustomHTML(_this.config.controls.customHTML.before,"controls","before"):"")+'<section class="me-controls">'+(_this.config.controls.customHTML.prepend?_this.injectCustomHTML(_this.config.controls.customHTML.prepend,"controls","prepend"):"")+_this._buildControlsVideoSectionHTML()+_this._buildControls360SectionHTML()+'<div class="me-controls-general"><button class="me-slideshow-play-pause me-btn'+(_this.config.slides.autoplay?" me-playing":"")+'"></button>'+_this._buildShare()+'<button class="me-fullscreen me-btn"></button></div>'+(_this.config.controls.customHTML.append?_this.injectCustomHTML(_this.config.controls.customHTML.append,"controls","append"):"")+"</section>"+(_this.config.controls.customHTML.after?_this.injectCustomHTML(_this.config.controls.customHTML.after,"controls","after"):"")},_this._buildControls360SectionHTML=function(){for(var html='<div class="me-controls-360 me-hide">',i=0;i<_this.config.controls.threeSixty.layout.length;i++)switch(_this.config.controls.threeSixty.layout[i]){case"pan":html+='<button class="me-360-pan-left me-btn"></button>',html+='<button class="me-360-pan-up me-btn"></button>',html+='<button class="me-360-pan-right me-btn"></button>',html+='<button class="me-360-pan-down me-btn"></button>';break;case"zoom":html+='<button class="me-360-zoom-in me-btn"></button>',html+='<button class="me-360-zoom-out me-btn"></button>'}return html+="</div>"},_this._buildControlsVideoSectionHTML=function(){for(var html='<div class="me-controls-video me-hide">',i=0;i<_this.config.controls.video.layout.length;i++)switch(_this.config.controls.video.layout[i]){case"progress-bar":html+='<input class="me-video-progress-bar" type="range" step="0.2" style="--min: 0; --max: 100; --val: 0;" value="0">';break;case"play-pause":html+='<button class="me-video-play-pause me-btn"></button>';break;case"timer":html+='<p class="me-video-timer" role="timer">00:00</p>';break;case"volume":html+='<div class="me-video-volume"><button class="me-video-volume-mute me-btn" aria-pressed="false"></button><button class="me-video-volume-level me-btn" data-level="0.2"></button><button class="me-video-volume-level me-btn" data-level="0.4"></button><button class="me-video-volume-level me-btn" data-level="0.6"></button><button class="me-video-volume-level me-btn" data-level="0.8"></button><button class="me-video-volume-level me-btn" data-level="1.0"></button></div>';break;case"cc":html+='<button class="me-video-cc me-btn" aria-pressed="false"></button>';break;case"dt":html+='<a class="me-video-dt me-btn" target="_blank" href=""></a>'}return html+="</div>"},_this._buildShare=function(){var shareHTML="";return _this.config.controls.general.shareLinks&&_this.config.controls.general.shareLinks instanceof Array&&_this.config.controls.general.shareLinks.length&&(shareHTML='<div class="me-share"><button class="me-share-toggle me-btn" aria-pressed="false"></button><ul class="me-share-links me-hide" aria-expanded="false">'+_this._buildShareAnchors()+"</ul></div>"),shareHTML},_this._buildShareAnchors=function(){for(var shareLinksHTML="",i=0;i<_this.config.controls.general.shareLinks.length;i++){var shareLink=_this.config.controls.general.shareLinks[i],shareLinkHTML="",shareLinkId=shareLink.linkId?shareLink.linkId:shareLink.name;switch(shareLink.type){case"baidu":case"email":case"facebook":case"pinterest":case"tumblr":case"twitter":case"weibo":case"whatsapp":shareLinkHTML+='<a class="me-share-link me-share-link-'+shareLink.type+'" href="#" name="'+shareLinkId+'" data-type="'+shareLink.type+'" target="_blank" rel="nofollow">'+shareLink.label+"</a>";break;case"custom":default:shareLinkHTML+='<a class="me-share-link '+shareLink.class+'" href="'+shareLink.href+'" name="'+shareLinkId+'" data-type="custom" target="'+shareLink.target+'" rel="nofollow">'+shareLink.label+"</a>"}shareLinksHTML+="<li>"+shareLinkHTML+"</li>"}return shareLinksHTML},_this._buildThumbnailsSectionHTML=function(){var thumbnailsULLIs=_this._buildThumbnailsULLIs();return(_this.config.thumbnails.customHTML.before?_this.injectCustomHTML(_this.config.thumbnails.customHTML.before,"thumbnails","before"):"")+'<nav class="me-thumbnails">'+(_this.config.thumbnails.customHTML.prepend?_this.injectCustomHTML(_this.config.thumbnails.customHTML.prepend,"thumbnails","prepend"):"")+'<div class="me-thumbnails-inner">'+(_this.config.thumbnails.controls?'<div class="me-thumbnails-controls"><button class="me-thumbnails-control-previous me-btn"></button><button class="me-thumbnails-control-next me-btn"></button></div>':"")+'<div class="me-thumbnails-media"><ul role="presentation" style="transition-duration: '+_this.config.thumbnails.transitionTime+'ms;">'+thumbnailsULLIs+"</ul></div></div>"+(_this.config.thumbnails.customHTML.append?_this.injectCustomHTML(_this.config.thumbnails.customHTML.append,"thumbnails","append"):"")+"</nav>"+(_this.config.thumbnails.customHTML.after?_this.injectCustomHTML(_this.config.thumbnails.customHTML.after,"thumbnails","after"):"")},_this._buildThumbnailsULLIs=function(){for(var thumbnailsULLIs="",i=0;i<_this.state.currentMediaSetTotalMedia;i++){var media=_this.state.currentMediaSetMedia[i];media.source&&(thumbnailsULLIs+='<li role="figure" data-media-index="'+i+'">'+_this._buildMediaThumbnailHTML(media)+"</li>")}return thumbnailsULLIs},_this._buildOtherHTML=function(){return'<button class="me-fullscreen-exit me-btn"></button>'},_this._buildRecommendations=function(){return'<section tabindex="0" class="me-media-recommendations"></section>'},_this._loadRecommendations=function(){var html="",recommendationsLength=_this.state.recommendations.source.length,firstScreen="";if(_this.els.recommendations=_this.els.container.querySelector(".me-media-recommendations"),_this.els.exitGav=_this.els.container.querySelector(".me-gav-exit"),"me-media-recommendations-3",firstScreen=recommendationsLength>=3?3:recommendationsLength,recommendationsLength>=1){html+='<div aria-label="Guests also viewed these recommendations" class="gav"><h2 alt="" tabindex="0" > Guests Also Viewed </h2><ol class="recs-ol" id="recommendations-group">';for(var i=0;i<firstScreen;i++){var recommendationMedia=_this.state.recommendations.source[i],thumbnail=recommendationMedia.picture?recommendationMedia.picture.desktop:recommendationMedia.img,name=recommendationMedia.name,themePark=recommendationMedia.themePark;html+='<li><a name="'+recommendationMedia.lid+'" class="me-media-recommendation" id="rec-'+i+'" href="'+recommendationMedia.url+'"><img src="'+thumbnail+'" alt="recommendation"><div class="recs-text"><h3>'+name+"</h3>",screen.width>=ME3.prototype.defaults.mobile&&(html+="<p>"+themePark+"</p>"),html+="</div></a></li>"}html+="</ol></div>"}_this.els.recommendations&&(_this.els.recommendations.innerHTML=html);var recsGroup=document.querySelectorAll("#recommendations-group li > a");for(i=0;i<recsGroup.length;i++)recsGroup[i].addEventListener("click",function(evt){var clickedRec=this,thisOnClick=_this.state.recommendations.source.filter(function(obj){return obj.lid===clickedRec.name})[0].onClick;_this.state.clickedRecommendation=JSON.parse(thisOnClick),_this.analyticsTrack("recommendationInteraction")})},_this.accessibilityInit=function(){_this.els.container.setAttribute("role","dialog"),_this.els.container.setAttribute("aria-modal","true"),_this.els.container.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].meTitle),_this.els.slidesControlPrevious.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].slidesControlPrevious),_this.els.slidesControlNext.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].slidesControlNext),_this.els.controlsVideoPlayPause.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].controlsVideoPlayPause),_this.els.controlsVideoVolumeMute.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].controlsVideoVolumeMute),_this.els.controlsVideoVolumeLevels[0].setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].controlsVideoVolumeLevel1),_this.els.controlsVideoVolumeLevels[1].setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].controlsVideoVolumeLevel2),_this.els.controlsVideoVolumeLevels[2].setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].controlsVideoVolumeLevel3),_this.els.controlsVideoVolumeLevels[3].setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].controlsVideoVolumeLevel4),_this.els.controlsVideoVolumeLevels[4].setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].controlsVideoVolumeLevel5),_this.els.controlsVideoCC.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].controlsVideoCC),_this.els.controlsVideoDT&&_this.els.controlsVideoDT.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].controlsVideoDT),_this.els.controlsGeneralSlideshowPlayPause.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].controlsGeneralSlideshowPlayPause),_this.els.controlsGeneralShare&&_this.els.controlsGeneralShareToggle.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].controlsGeneralShareToggle),_this.els.controlsGeneralFullscreen.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].controlsGeneralFullscreen),_this.state.thumbnailsEnabled&&_this.config.thumbnails.controls&&(_this.els.thumbnailsControlPrevious.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].thumbnailsControlPrevious),_this.els.thumbnailsControlNext.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].thumbnailsControlNext)),_this.els.fullscreenExit.setAttribute("aria-label",_this.config.accessibility.labels[_this.state.language].fullscreenExit)},_this.bindAccessibilityEventListeners=function(){var tabbableEls=_this.els.container.querySelectorAll('button.me-btn, .me-video-progress-bar, [tabindex="0"]');_this.state.accessibility.firstTabbableEl=tabbableEls[0],_this.state.accessibility.lastTabbableEl=tabbableEls[tabbableEls.length-1],_this.els.container.addEventListener("keydown",_this.keyHandler)},_this.unbindAccessibilityEventListeners=function(){_this.els.container.removeEventListener("keydown",_this.keyHandler)},_this.keyHandler=function(e){e=e||window.event,_this.state.fullscreen&&("key"in e&&"Tab"===e.key||9===e.keyCode)&&(e.shiftKey?document.activeElement===_this.state.accessibility.firstTabbableEl&&(e.preventDefault(),_this.state.accessibility.lastTabbableEl.focus()):document.activeElement===_this.state.accessibility.lastTabbableEl&&(e.preventDefault(),_this.state.accessibility.firstTabbableEl.focus()))},_this.getSupportedVideoSource=function(videoSources){var testVideo=document.createElement("video"),supportedVideoPattern=/\.(mp4|webm)/,supportedVideoSource="";for(var i in videoSources){var videoSource=videoSources[i],videoExtension="";if(supportedVideoPattern.test(videoSource)&&void 0!==videoSource.split(supportedVideoPattern)[1]&&(videoExtension=videoSource.split(supportedVideoPattern)[1],"probably"===testVideo.canPlayType("video/"+videoExtension)||"maybe"===testVideo.canPlayType("video/"+videoExtension))){supportedVideoSource=videoSource;break}}return supportedVideoSource},_this.injectCustomHTML=function(customHTML,section,subsection){return'<section class="me-custom-html me-custom-html-'+section+"-"+subsection+'">'+_this.replaceTokens(customHTML)+"</section>"},_this.replaceTokens=function(html){return html.replace("${totalMedia}",_this.state.totalMedia)},_this.suppressSlidingTransitions=function(){_this.els.slidesMediaUL.classList.add("me-no-transition"),_this.state.thumbnailsEnabled&&_this.els.thumbnailsUL.classList.add("me-no-transition")},_this.unsuppressSlidingTransitions=function(){_this.els.slidesMediaUL.classList.remove("me-no-transition"),_this.state.thumbnailsEnabled&&_this.els.thumbnailsUL.classList.remove("me-no-transition")},_this.bindEventListeners=function(init){init&&(_this.state.touch.supported?(_this.els.container.addEventListener("touchstart",_this.idleTimerReset),_this.els.slidesMediaUL.addEventListener("touchstart",function(e){_this.state.touch.slides.preDragLeft=parseInt(_this.els.slidesMediaUL.style.left),_this.state.touch.slides.startX=e.changedTouches[0].screenX,_this.state.touch.slides.startY=e.changedTouches[0].screenY}),_this.els.slidesMediaUL.addEventListener("touchmove",function(e){var dragX;_this.state.touch.slides.moveX=e.changedTouches[0].screenX,_this.state.touch.slides.moveY=e.changedTouches[0].screenY,dragX=_this.state.touch.slides.moveX-_this.state.touch.slides.startX,_this.els.slidesMediaUL.style.left=_this.state.touch.slides.preDragLeft+dragX+"px"}),_this.els.slidesMediaUL.addEventListener("touchend",function(e){var touchType="";_this.state.touch.slides.endX=e.changedTouches[0].screenX,_this.state.touch.slides.endY=e.changedTouches[0].screenY,Math.abs(_this.state.touch.slides.endX-_this.state.touch.slides.startX)<=10&&Math.abs(_this.state.touch.slides.endY-_this.state.touch.slides.startY)<=10?touchType="tap":_this.state.touch.slides.endX<_this.state.touch.slides.startX?touchType="left":_this.state.touch.slides.endX>_this.state.touch.slides.startX&&(touchType="right"),"tap"===touchType?_this._fullscreenOnTouchOrClickEnabledAndNotFullscreen()?_this.fullscreenEnterHandler():_this.state.fullscreen&&(_this.state.tapToggle?(_this.state.tapToggle=!1,_this.els.container.classList.remove("me-tap-toggle")):(_this.state.tapToggle=!0,_this.els.container.classList.add("me-tap-toggle"))):Math.abs(_this.state.touch.slides.endX-_this.state.touch.slides.startX)<80?_this.cancelSwipe():"left"===touchType?_this.loadSlideNext():"right"===touchType&&_this.loadSlidePrevious()}),_this.els.controlsVideoProgressBar.addEventListener("input",_this.videoProgressBarInputHandler),_this.els.controlsVideoProgressBar.addEventListener("change",_this.videoProgressBarInputHandler),_this.state.ios&&_this.els.controlsVideoProgressBar.addEventListener("touchstart",_this.videoProgressBarInputHandlerIOS)):(_this.els.container.addEventListener("click",function(e){(_this.els.tabs.contains(e.target)||_this.state.thumbnailsEnabled&&_this.els.thumbnails.contains(e.target)||!e.target.classList.contains("me-image-next-overlay")&&!e.target.classList.contains("me-cinemagraph-next-overlay")&&!e.target.classList.contains("me-video-play-pause-overlay")&&!e.target.classList.contains("me-youtube-play-pause-overlay")&&e.target!==_this.els.slidesControlPrevious&&e.target!==_this.els.slidesControlNext)&&_this.idleTimerReset()}),_this.els.container.addEventListener("mousemove",function(e){_this.state.threeSixty.mouseDown||_this.idleTimerReset()}),_this.els.container.addEventListener("keydown",function(e){("key"in e&&"Tab"===e.key||9===e.keyCode)&&_this.idleTimerReset()}),_this.els.controlsVideoProgressBar.addEventListener("keydown",_this.idleTimerReset),_this.config.slides.fullscreenOnTouchOrClick&&_this.els.slidesMediaUL.addEventListener("click",function(){_this.state.fullscreen||"recommendations"===_this.state.currentMediaType||_this.fullscreenEnterHandler()}),_this.els.controlsVideoProgressBar.addEventListener("input",_this.videoProgressBarInputHandler),_this.state.ie10Or11&&_this.els.controlsVideoProgressBar.addEventListener("change",_this.videoProgressBarInputHandler),_this.els.container.addEventListener("keydown",function(e){if("key"in(e=e||window.event))if("Space"===e.key||32===e.keyCode)e.preventDefault(),"video"===_this.state.currentMediaType||"video-360"===_this.state.currentMediaType||"youtube"===_this.state.currentMediaType?_this.videoPlayPause(!0):"image"!==_this.state.currentMediaType&&"cinemagraph"!==_this.state.currentMediaType||_this.loadSlideNext();else if("Left"===e.key||37===e.keyCode)if(_this.els.controlsVideoVolume.contains(document.activeElement)){var activeVolumeEl=_this.els.controlsVideoVolume.querySelector('[data-level="'+_this.state.videoVolumeLevel.toFixed(1)+'"');if(.2===_this.state.videoVolumeLevel)_this.videoVolumeMute(),_this.els.controlsVideoVolumeMute.focus();else{var previousVolumeEl=activeVolumeEl.previousSibling;previousVolumeEl&&(previousVolumeEl.click(),previousVolumeEl.focus())}}else _this.state.thumbnailsEnabled&&!_this.els.thumbnailsUL.contains(document.activeElement)?(_this.els.slidesControlPrevious.focus(),_this.loadSlidePrevious()):_this.loadSlidePrevious(null,!0);else if("Right"===e.key||39===e.keyCode)if(_this.els.controlsVideoVolume.contains(document.activeElement)){activeVolumeEl=_this.els.controlsVideoVolume.querySelector('[data-level="'+_this.state.videoVolumeLevel.toFixed(1)+'"');if(_this.state.videoVolumeMuted)activeVolumeEl.click();else if(_this.state.videoVolumeLevel<1){var nextVolumeEl=activeVolumeEl.nextSibling;nextVolumeEl&&(nextVolumeEl.click(),nextVolumeEl.focus())}}else _this.state.thumbnailsEnabled&&!_this.els.thumbnailsUL.contains(document.activeElement)?(_this.els.slidesControlNext.focus(),_this.loadSlideNext()):_this.loadSlideNext(null,!0)}),_this.els.controlsVideoProgressBar.addEventListener("keydown",function(e){e.stopPropagation()}),_this.els.container.querySelectorAll("section, nav").forEach(function(el){el.addEventListener("focusin",function(){el.classList.add("me-focused")}),el.addEventListener("focusout",function(){el.classList.remove("me-focused")})}),_this.els.controlsVideoDT&&_this.els.controlsVideoDT.addEventListener("click",function(e){_this.els.controlsVideoDT.getAttribute("href")||e.preventDefault()}),_this.els.controlsGeneralShare&&(_this.els.controlsGeneralShareLinks.addEventListener("mouseleave",_this.shareHide),_this.els.controlsGeneralShareLinksLIs.forEach(function(el){el.querySelector("a").addEventListener("click",_this.shareLinkHandler)}))),window.addEventListener("resize",function(){window.clearTimeout(_this.state.resizeId),_this.state.resizeId=window.setTimeout(_this.resizeEnd,0),_this.suppressSlidingTransitions(),_this.calculateWidths()}),_this.els.container.querySelectorAll(".me-custom-html a").forEach(function(el){el.addEventListener("keydown",function(e){("key"in(e=e||window.event)&&"Space"===e.key||32===e.keyCode)&&el.click()})}),_this.els.tabsAnchors.forEach(function(el){el.addEventListener(_this.state.touchOrClick,function(e){var tabIndex=0;this.classList.contains("me-active")||(tabIndex=parseInt(this.getAttribute("data-tab-index")),_this.changeMediaSet(tabIndex))})}),_this.els.slidesControlPrevious.addEventListener(_this.state.touchOrClick,_this.loadSlidePrevious),_this.els.slidesControlNext.addEventListener(_this.state.touchOrClick,_this.loadSlideNext),_this.els.controlsVideoPlayPause.addEventListener(_this.state.touchOrClick,function(){_this.videoPlayPause(!0)}),_this.els.controlsVideoVolumeMute.addEventListener(_this.state.touchOrClick,_this.videoVolumeMuteUnmute),_this.els.controlsVideoVolumeLevels.forEach(function(el){el.addEventListener(_this.state.touchOrClick,function(e){_this.videoVolumeSetLevel(parseFloat(e.target.getAttribute("data-level")))})}),_this.els.controlsVideoCC.addEventListener(_this.state.touchOrClick,_this.toggleCC),_this.els.controlsGeneralSlideshowPlayPause.addEventListener(_this.state.touchOrClick,_this.slideshowPlayPause),_this.els.controlsGeneralFullscreen.addEventListener(_this.state.touchOrClick,_this.toggleFullscreen),_this.state.thumbnailsEnabled&&_this.config.thumbnails.controls&&(_this.els.thumbnailsControlPrevious.addEventListener(_this.state.touchOrClick,function(e){0!==_this.state.currentThumbnailPage&&(_this.state.currentThumbnailPage=_this.state.currentThumbnailPage-1,_this.updateThumbnailsPage(),_this.updateThumbnailsControlStates())}),_this.els.thumbnailsControlNext.addEventListener(_this.state.touchOrClick,function(e){_this.state.currentThumbnailPage!==_this.state.totalThumbnailPages-1&&(_this.state.currentThumbnailPage=_this.state.currentThumbnailPage+1,_this.updateThumbnailsPage(),_this.updateThumbnailsControlStates())})),_this.els.controlsGeneralShare&&(_this.els.controlsGeneralShareToggle.addEventListener(_this.state.touchOrClick,_this.toggleShare),_this.els.controlsGeneralShare.previousSibling.addEventListener("focus",function(e){_this.shareHide(!0)}),_this.els.controlsGeneralShare.nextSibling.addEventListener("focus",function(e){_this.shareHide(!0)}),_this.els.controlsGeneralShareLinksLIs.forEach(function(el){el.querySelector("a").addEventListener(_this.state.touchOrClick,function(){_this.analyticsTrack(this.getAttribute("data-type"))})})),_this.els.fullscreenExit.addEventListener(_this.state.touchOrClick,_this.fullscreenExitHandler),_this.els.container.addEventListener("keydown",function(e){e=e||window.event,_this.state.fullscreen&&("key"in e&&("Escape"===e.key||"Esc"===e.key)||27===e.keyCode)&&_this.fullscreenExitHandler()}),_this.state.fullscreenAPISupported&&_this.config.slides.fullscreenAPIEnabled&&(document.addEventListener("fullscreenchange",function(){document.fullscreenElement||_this.fullscreenExitHandler()}),document.addEventListener("webkitfullscreenchange",function(){document.webkitIsFullScreen||_this.fullscreenExitHandler()}),document.addEventListener("mozfullscreenchange",function(){document.mozFullScreen||_this.fullscreenExitHandler()}),document.addEventListener("MSFullscreenChange",function(){null===document.msFullscreenElement&&_this.fullscreenExitHandler()}))),_this.els.slidesMediaULLIs.forEach(function(el){var image=el.querySelector(".me-media-image"),cinemagraph=el.querySelector(".me-media-cinemagraph");image?(image.addEventListener("load",function(){image.naturalHeight===image.naturalWidth&&el.classList.add("me-ratio-square")}),!_this.state.touch.supported&&el.querySelector(".me-image-next-overlay")&&el.querySelector(".me-image-next-overlay").addEventListener("click",function(){_this._fullscreenOnTouchOrClickEnabledAndNotFullscreen()||_this.loadSlideNext()})):cinemagraph&&!_this.state.touch.supported&&el.querySelector(".me-cinemagraph-next-overlay")&&el.querySelector(".me-cinemagraph-next-overlay").addEventListener("click",function(){_this._fullscreenOnTouchOrClickEnabledAndNotFullscreen()||_this.loadSlideNext()})}),_this.config.slides.timeline&&_this.els.slidesTimelineBars.forEach(function(el){el.addEventListener(_this.state.touchOrClick,function(e){var targetSlide=parseInt(this.getAttribute("data-bar"));_this.loadSlide(targetSlide)})}),_this.state.thumbnailsEnabled&&_this.els.thumbnailsULLIs.forEach(function(el){var image=el.querySelector("img");if(image&&(image.addEventListener("load",function(){image.classList.add("me-load-success"),_this.thumbnailImagesLoadedHandler()}),image.addEventListener("error",function(){console.error("ME3: Thumbnail image failed to load.",image.src),image.classList.add("me-load-error"),_this.thumbnailImagesLoadedHandler()})),el.addEventListener(_this.state.touchOrClick,function(e){var mediaIndex=parseInt(this.getAttribute("data-media-index"));mediaIndex!==_this.state.currentMediaIndex&&_this.loadSlide(mediaIndex,!0)}),!_this.state.touch.supported){var videoPreviewEl=el.querySelector(".me-video-preview");videoPreviewEl&&(videoPreviewEl.playbackRate=2,el.addEventListener("mouseenter",function(e){videoPreviewEl.play()}),el.addEventListener("mouseleave",function(e){videoPreviewEl.pause(),videoPreviewEl.currentTime=0}))}})},_this.thumbnailImagesLoadedHandler=function(){_this.state.thumbnailImagesLoadedCounter++,_this.state.thumbnailImagesLoadedCounter===_this.state.currentMediaSet.media.length&&_this.calculateWidths()},_this.cancelSwipe=function(){_this.els.slidesMediaUL.style.left=_this.state.touch.slides.preDragLeft+"px"},_this.resizeEnd=function(){_this.unsuppressSlidingTransitions()},_this.toggleCC=function(){_this.state.cc?_this.ccHide():_this.ccShow()},_this.ccShow=function(){_this.els.slidesCC.classList.remove("me-hide"),_this.els.controlsVideoCC.classList.add("me-active"),_this.state.cc=!0,_this.els.controlsVideoCC.setAttribute("aria-pressed","true"),_this.analyticsTrack("closedCaptionOn")},_this.ccHide=function(){_this.els.slidesCC.classList.add("me-hide"),_this.els.controlsVideoCC.classList.remove("me-active"),_this.state.cc=!1,_this.els.controlsVideoCC.setAttribute("aria-pressed","false"),_this.analyticsTrack("closedCaptionOff")},_this.toggleShare=function(){_this.els.controlsGeneralShareToggle.classList.contains("me-active")?_this.shareHide():_this.shareShow()},_this.shareShow=function(){_this.els.controlsGeneralShareToggle.classList.add("me-active"),_this.els.controlsGeneralShareToggle.setAttribute("aria-pressed","true"),_this.els.controlsGeneralShareLinks.classList.remove("me-hide"),_this.els.controlsGeneralShareLinks.setAttribute("aria-expanded","true"),_this.analyticsTrack("share")},_this.shareHide=function(blur){_this.els.controlsGeneralShareToggle.classList.remove("me-active"),_this.els.controlsGeneralShareToggle.setAttribute("aria-pressed","false"),_this.els.controlsGeneralShareLinks.classList.add("me-hide"),_this.els.controlsGeneralShareLinks.setAttribute("aria-expanded","false"),blur&&_this.els.controlsGeneralShareToggle.blur()},_this.shareUpdateLinks=function(){_this.els.controlsGeneralShareLinksLIs&&_this.els.controlsGeneralShareLinksLIs.forEach(function(el){var shareLink=el.querySelector(".me-share-link"),type=shareLink.getAttribute("data-type"),shareUrl="",shareTitle="",shareSize="",url=window.location.href.replace(/\?media=\d*\/\d*/,""),currentMediaEl=null;if("custom"!==type){switch("image"===_this.state.currentMediaType||"video"===_this.state.currentMediaType||"cinemagraph"===_this.state.currentMediaType?(currentMediaEl=_this.state.currentMediaEl.querySelector("img, video"),url+="?media="+_this.state.currentMediaSetIndex+"/"+_this.state.currentMediaIndex,shareTitle=currentMediaEl.getAttribute("alt")):shareTitle=document.title,type){case"baidu":shareSize="height=400,width=700",shareUrl="http://tieba.baidu.com/f/commit/share/openShareApi?"+("url="+encodeURIComponent(url)+"&title="+encodeURIComponent(shareTitle));break;case"email":shareUrl="mailto:%20?"+("subject="+encodeURIComponent(shareTitle)+"&body="+encodeURIComponent(url));break;case"facebook":shareSize="height=400,width=700",shareUrl="https://www.facebook.com/sharer/sharer.php?"+("u="+encodeURIComponent(url)+"&t="+encodeURIComponent(shareTitle));break;case"pinterest":shareSize="height=400,width=700",shareUrl="https://pinterest.com/pin/create/button/?"+("url="+encodeURIComponent(url)+"&description="+encodeURIComponent(shareTitle)+"&media="+encodeURIComponent(url));break;case"tumblr":shareSize="height=400,width=700",shareUrl="https://www.tumblr.com/widgets/share/tool/preview?shareSource=legacy&canonicalUrl=&"+("url="+encodeURIComponent(url)+"&title="+encodeURIComponent(shareTitle));break;case"twitter":shareSize="height=444,width=700",shareUrl="https://twitter.com/intent/tweet?"+("url="+encodeURIComponent(url)+"&text="+encodeURIComponent(shareTitle));break;case"weibo":shareSize="height=400,width=700",shareUrl="http://service.weibo.com/share/share.php?"+("url="+encodeURIComponent(url)+"&title="+encodeURIComponent(shareTitle));break;case"whatsapp":shareSize="height=400,width=700",shareUrl="https://web.whatsapp.com/send?"+("text="+encodeURIComponent(shareTitle+" "+url))}shareLink.setAttribute("href",shareUrl),shareLink.setAttribute("data-share-title",shareTitle),shareLink.setAttribute("data-share-size",shareSize)}})},_this.shareLinkHandler=function(e){var shareLink=e.target,type=shareLink.getAttribute("data-type"),shareLinkUrl=shareLink.getAttribute("href"),shareLinkTitle=shareLink.getAttribute("data-share-title"),shareLinkSize=shareLink.getAttribute("data-share-size");if("custom"!==type)switch(e.preventDefault(),type){case"baidu":window.open(shareLinkUrl,shareLinkTitle,shareLinkSize);break;case"email":window.location=shareLinkUrl;break;case"facebook":case"pinterest":case"tumblr":case"twitter":case"weibo":case"whatsapp":window.open(shareLinkUrl,shareLinkTitle,shareLinkSize)}},_this.toggleFullscreen=function(){_this.state.fullscreen?_this.fullscreenExitHandler():_this.fullscreenEnterHandler()},_this.fullscreenEnterHandler=function(){_this.state.fullscreenEntering=!0,"function"==typeof _this.config.callbacks.customFullscreenEnter?_this.config.callbacks.customFullscreenEnter():(_this.fullscreenEnter(),_this.fullscreenAPIEnter(),_this.loadSlide(_this.state.currentMediaIndex))},_this.fullscreenEnter=function(){_this.suppressSlidingTransitions(),_this.els.body.classList.add("me-scroll-lock"),_this.els.controlsGeneralFullscreen.classList.add("me-active"),_this.els.container.classList.add("me-fullscreen"),_this.state.accessibility.firstTabbableEl.focus(),_this.state.fullscreen=!0,_this.state.fullscreenEntering=!1,_this.calculateWidths(),window.setTimeout(_this.unsuppressSlidingTransitions,0),_this.els.container.setAttribute("tabindex","-1"),_this.videoVolumeFullscreenInit()},_this.fullscreenAPIEnter=function(){if(_this.state.fullscreenAPISupported&&_this.config.slides.fullscreenAPIEnabled&&!_this.state.touch.supported){var container=_this.els.container;container.requestFullscreen?container.requestFullscreen():container.webkitRequestFullscreen?container.webkitRequestFullscreen():container.mozRequestFullScreen?container.mozRequestFullScreen():container.msRequestFullscreen&&container.msRequestFullscreen()}},_this.fullscreenExitHandler=function(){_this.state.fullscreenExiting=!0,"function"==typeof _this.config.callbacks.customFullscreenExit?_this.config.callbacks.customFullscreenExit():(_this.fullscreenExit(),_this.fullscreenAPIExit(),_this.loadSlide(_this.state.currentMediaIndex)),"video"!==_this.state.currentMediaType&&"video-360"!==_this.state.currentMediaType||_this.analyticsTrack("videoClose")},_this.fullscreenExit=function(){_this.suppressSlidingTransitions(),_this.els.body.classList.remove("me-scroll-lock"),_this.els.container.removeAttribute("role"),_this.els.controlsGeneralFullscreen.classList.remove("me-active"),_this.els.container.classList.remove("me-fullscreen"),_this.els.container.focus(),_this.state.fullscreen=!1,_this.state.fullscreenExiting=!1,_this.calculateWidths(),window.setTimeout(_this.unsuppressSlidingTransitions,0),_this.els.container.setAttribute("tabindex","0"),_this.videoVolumeInit()},_this.fullscreenAPIExit=function(){_this.state.fullscreenAPISupported&&_this.config.slides.fullscreenAPIEnabled&&!_this.state.touch.supported&&(document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.exitFullscreen&&document.exitFullscreen())},_this.bindVideoEventListeners=function(){_this.state.currentMediaElVideo.addEventListener("durationchange",_this.videoProgressBarSetDuration),_this.state.currentMediaElVideo.addEventListener("timeupdate",_this.videoTimeUpdate),_this.state.currentMediaElVideo.addEventListener("ended",_this.videoEndedHandler),_this.state.currentMediaElVideoPlayPauseOverlay.addEventListener(_this.state.touchOrClick,_this.videoPlayPauseOverlayHandler)},_this.unbindVideoEventListeners=function(){_this.state.currentMediaElVideo.removeEventListener("durationchange",_this.videoProgressBarSetDuration),_this.state.currentMediaElVideo.removeEventListener("timeupdate",_this.videoTimeUpdate),_this.state.currentMediaElVideo.removeEventListener("ended",_this.videoEndedHandler),_this.state.currentMediaElVideoPlayPauseOverlay.removeEventListener(_this.state.touchOrClick,_this.videoPlayPauseOverlayHandler)},_this.bindYouTubeEventListeners=function(){_this.state.youTubeAPIScriptLoaded?window.setTimeout(window.onYouTubeIframeAPIReady,0):(_this.loadYouTubeAPIScript(),window.onYouTubeIframeAPIReady=function(){var youTubeId=_this.state.currentMediaSetMediaItem.source;_this.state.youTubePlayers[youTubeId]?_this.onYouTubePlayerReady():_this.state.youTubePlayers[youTubeId]=new YT.Player("me-media-youtube-"+youTubeId,{height:"100%",playerVars:{autoplay:1,controls:0,enablejsapi:1,fs:0,modestbranding:1,origin:null,playsinline:1,rel:0,showinfo:0},width:"100%",videoId:youTubeId,events:{onReady:_this.onYouTubePlayerReady,onStateChange:function(e){e.data===YT.PlayerState.PLAYING?(_this.videoProgressBarSetDuration(),_this.state.currentYouTubePlayer.getOption("captions","track")&&_this.state.currentYouTubePlayer.getOption("captions","track").format?_this.els.controlsVideo.classList.add("me-has-youtube-captions"):_this.els.controlsVideo.classList.remove("me-has-youtube-captions")):e.data===YT.PlayerState.ENDED&&_this.videoEndedHandler()}}})})},_this.loadYouTubeAPIScript=function(){var youTubeAPIScript=document.createElement("script");youTubeAPIScript.src=ME3.prototype.utilities.url.getURLProtocol()+"//www.youtube.com/iframe_api",youTubeAPIScript.onload=function(){_this.state.youTubeAPIScriptLoaded=!0},_this.els.body.appendChild(youTubeAPIScript)},_this.onYouTubePlayerReady=function(){var youTubeId=_this.state.currentMediaSetMediaItem.source;_this.state.currentMediaElYouTube=_this.state.currentMediaEl.querySelector("iframe"),_this.state.currentMediaElYouTube.setAttribute("tabindex","-1"),_this.state.currentYouTubePlayer=_this.state.youTubePlayers[youTubeId],_this.state.currentMediaElYouTubePlayPauseOverlay.addEventListener(_this.state.touchOrClick,_this.videoPlayPauseOverlayHandler),_this.videoVolumeApplyToCurrentVideo(),window.clearTimeout(_this.state.slideshowId),_this.videoPlay()},_this.unbindYouTubeEventListeners=function(){_this.state.currentYouTubePlayer&&_this.state.currentYouTubePlayer.stopVideo(),_this.state.currentYouTubePlayer=null,window.clearInterval(_this.state.currentYouTubePlayerTimeUpdateId),_this.state.currentMediaElYouTube=null,_this.state.currentMediaElYouTubePlayPauseOverlay=null,_this.els.controlsVideo.classList.remove("me-has-youtube-captions")},_this.destroyYouTubePlayers=function(){try{for(var i in _this.state.youTubePlayers)_this.state.youTubePlayers[i].destroy();_this.state.currentYouTubePlayer=null,window.clearInterval(_this.state.currentYouTubePlayerTimeUpdateId),_this.state.youTubePlayers={}}catch(err){console.log(err)}},_this._fullscreenOnTouchOrClickEnabledAndNotFullscreen=function(){return _this.config.slides.fullscreenOnTouchOrClick&&!_this.state.fullscreen},_this.videoPlayPauseOverlayHandler=function(){_this._fullscreenOnTouchOrClickEnabledAndNotFullscreen()||_this.videoPlayPause(!0)},_this.videoPlayPause=function(track){window.clearTimeout(_this.state.slideshowId),"video"===_this.state.currentMediaType||"video-360"===_this.state.currentMediaType?_this.state.currentMediaElVideo.paused?_this.videoPlay(track):_this.videoPause(track):"youtube"===_this.state.currentMediaType&&(1!==_this.state.currentYouTubePlayer.getPlayerState()?5===_this.state.currentYouTubePlayer.getPlayerState()?(_this.videoResetTime(),_this.onYouTubePlayerReady()):_this.videoPlay():_this.videoPause())},_this.videoPlay=function(track,tryOnceMore){var playPromise;"video"===_this.state.currentMediaType||"video-360"===_this.state.currentMediaType?_this.state.currentMediaElVideo.paused?void 0!==(playPromise=_this.state.currentMediaElVideo.play())?playPromise.then(function(){console.log("Playback successful."),_this._videoPlayHandler()}).catch(function(error){console.log("Playback error."),console.dir(error),tryOnceMore||("AbortError"===error.name||"NotAllowedError"===error.name?_this.videoPlay(track,!0):_this.state.currentMediaElVideo.paused||_this._videoPlayHandler())}):_this.state.currentMediaElVideo.paused||_this._videoPlayHandler():(console.log("Video is already playing."),_this._videoPlayHandler()):"youtube"===_this.state.currentMediaType&&(_this.state.currentYouTubePlayer.playVideo(),_this.state.currentYouTubePlayerTimeUpdateId=window.setInterval(_this.videoTimeUpdate,500),_this._videoPlayHandler())},_this._videoPlayHandler=function(){_this._videoPlayAddClasses(),"video"!==_this.state.currentMediaType&&"video-360"!==_this.state.currentMediaType||0===_this.state.currentMediaElVideo.currentTime&&_this.analyticsTrack("videoStart")},_this._videoPlayAddClasses=function(){"video"===_this.state.currentMediaType||"video-360"===_this.state.currentMediaType?_this.state.currentMediaElVideoPlayPauseOverlay.classList.add("me-playing"):"youtube"===_this.state.currentMediaType&&_this.state.currentMediaElYouTubePlayPauseOverlay.classList.add("me-playing"),_this.state.currentMediaEl.classList.add("me-playing"),_this.els.controlsVideoPlayPause.classList.add("me-playing")},_this.videoPause=function(track){"video"===_this.state.currentMediaType||"video-360"===_this.state.currentMediaType?_this.state.currentMediaElVideo.pause():"youtube"===_this.state.currentMediaType&&(_this.state.currentYouTubePlayer.pauseVideo(),window.clearInterval(_this.state.currentYouTubePlayerTimeUpdateId)),_this._videoPlayRemoveClasses(),track&&_this.analyticsTrack("videoPause")},_this._videoPlayRemoveClasses=function(){"video"===_this.state.currentMediaType||"video-360"===_this.state.currentMediaType?_this.state.currentMediaElVideoPlayPauseOverlay.classList.remove("me-playing"):"youtube"===_this.state.currentMediaType&&_this.state.currentMediaElYouTubePlayPauseOverlay.classList.remove("me-playing"),_this.state.currentMediaEl.classList.remove("me-playing"),_this.els.controlsVideoPlayPause.classList.remove("me-playing")},_this.videoEndedHandler=function(){"video"===_this.state.currentMediaType||"video-360"===_this.state.currentMediaType||"youtube"===_this.state.currentMediaType&&(window.clearInterval(_this.state.currentYouTubePlayerTimeUpdateId),_this.state.currentYouTubePlayer.stopVideo()),_this.videoPause(),_this.queueLoadSlideNext()},_this.videoProgressBarSetDuration=function(){var videoDuration="video"===_this.state.currentMediaType||"video-360"===_this.state.currentMediaType?_this.state.currentMediaElVideo.duration:_this.state.currentYouTubePlayer.getDuration();_this.els.controlsVideoProgressBar.setAttribute("max",videoDuration),_this.els.controlsVideoProgressBar.max=videoDuration,_this.els.controlsVideoProgressBar.style.setProperty("--max",videoDuration)},_this.videoVolumeInit=function(){(_this.videoVolumeMutePreferenceRead()||_this.config.video.muted)&&_this.videoVolumeMute()},_this.videoVolumeFullscreenInit=function(){_this.videoVolumeMutePreferenceRead()?_this.videoVolumeMute():_this.config.video.unmuteOnFullscreen&&_this.videoVolumeUnmute()},_this.videoVolumeMutePreferenceRead=function(){return!(!ME3.prototype.utilities.storage.localStorageIsSupported()||!localStorage.getItem("ME_volume_mute"))&&localStorage.getItem("ME_volume_mute")},_this.videoVolumeMutePreferenceSave=function(action){ME3.prototype.utilities.storage.localStorageIsSupported()&&("add"===action?localStorage.setItem("ME_volume_mute","true"):localStorage.removeItem("ME_volume_mute"))},_this.videoVolumeMuteUnmute=function(){_this.state.videoVolumeMuted?(_this.videoVolumeUnmute(!0),_this.videoVolumeMutePreferenceSave("remove")):(_this.videoVolumeMute(!0),_this.videoVolumeMutePreferenceSave("add"))},_this.videoVolumeMute=function(track){_this.state.videoVolumeMuted=!0,_this.els.controlsVideoVolumeMute.classList.add("me-active"),_this.els.controlsVideoVolumeMute.setAttribute("aria-pressed","true"),_this.videoVolumeSetLevelBars(),_this.videoVolumeApplyToCurrentVideo(),track&&_this.analyticsTrack("muteOn")},_this.videoVolumeUnmute=function(track){_this.state.videoVolumeMuted=!1,_this.els.controlsVideoVolumeMute.classList.remove("me-active"),_this.els.controlsVideoVolumeMute.setAttribute("aria-pressed","false"),_this.videoVolumeSetLevelBars(),_this.videoVolumeApplyToCurrentVideo(),track&&_this.analyticsTrack("muteOff")},_this.videoVolumeSetLevel=function(volumeLevel){_this.state.videoVolumeLevel=volumeLevel,_this.state.videoVolumeMuted?(_this.videoVolumeUnmute(),_this.videoVolumeMutePreferenceSave("remove")):(_this.videoVolumeSetLevelBars(),_this.videoVolumeApplyToCurrentVideo())},_this.videoVolumeSetLevelBars=function(){_this.els.controlsVideoVolumeLevels.forEach(function(el){_this.state.videoVolumeMuted?el.classList.remove("me-active"):_this.state.videoVolumeLevel>=parseFloat(el.getAttribute("data-level"))?el.classList.add("me-active"):el.classList.remove("me-active")})},_this.videoVolumeApplyToCurrentVideo=function(){var volumeLevel=_this.state.videoVolumeLevel;"video"===_this.state.currentMediaType||"video-360"===_this.state.currentMediaType?(_this.state.currentMediaElVideo.volume=volumeLevel,_this.state.videoVolumeMuted?(_this.state.currentMediaElVideo.setAttribute("muted",""),_this.state.currentMediaElVideo.muted=!0):(_this.state.currentMediaElVideo.removeAttribute("muted"),_this.state.currentMediaElVideo.muted=!1)):"youtube"===_this.state.currentMediaType&&(_this.state.currentYouTubePlayer.setVolume(100*volumeLevel),_this.state.videoVolumeMuted?_this.state.currentYouTubePlayer.mute():_this.state.currentYouTubePlayer.unMute())},_this.videoLoop=function(){_this.state.currentMediaElVideo.setAttribute("loop","")},_this.videoTimeUpdate=function(noTrack){var displayTime,totalSeconds="video"===_this.state.currentMediaType||"video-360"===_this.state.currentMediaType?_this.state.currentMediaElVideo.currentTime:_this.state.currentYouTubePlayer.getCurrentTime(),seconds=0,minutes=Math.floor(totalSeconds/60),videoDuration="video"===_this.state.currentMediaType||"video-360"===_this.state.currentMediaType?_this.state.currentMediaElVideo.duration:_this.state.currentYouTubePlayer.getDuration(),progressValue=totalSeconds,percentPlayed=Math.round(totalSeconds/videoDuration*100);displayTime=(minutes=minutes>=10?minutes:"0"+minutes)+":"+(seconds=(seconds=Math.floor(totalSeconds%60))>=10?seconds:"0"+seconds),_this.els.controlsVideoTimer.innerHTML=displayTime,_this.els.controlsVideoProgressBar.setAttribute("value",progressValue),_this.els.controlsVideoProgressBar.value=progressValue,_this.els.controlsVideoProgressBar.style.setProperty("--val",progressValue),_this.state.cc&&_this.state.currentMediaSetMediaItem.closedCaptioning&&_this.updateCCBasedOnVideoTime(totalSeconds),_this.state.currentTimelineBar&&(_this.state.currentTimelineBar.querySelector(".me-slides-timeline-bar-fill").style.width=percentPlayed+"%"),!0!==noTrack&&(percentPlayed<=1?_this.analyticsTrack("videoView"):25===percentPlayed||50===percentPlayed||75===percentPlayed?_this.analyticsTrack("videoPct"+percentPlayed):percentPlayed>=99&&_this.analyticsTrack("videoStop"))},_this.videoProgressBarInputHandler=function(e){_this.analyticsTrackOnceReset("videoView"),_this.videoJumpTo(_this.els.controlsVideoProgressBar.value),_this.videoTimeUpdate(!0)},_this.videoProgressBarInputHandlerIOS=function(e){_this.els.controlsVideoProgressBar.value=e.target.max/e.target.offsetWidth*(e.touches[0].screenX-e.target.offsetLeft),_this.videoProgressBarInputHandler()},_this.videoJumpTo=function(seconds){"video"===_this.state.currentMediaType||"video-360"===_this.state.currentMediaType?_this.state.currentMediaElVideo.currentTime=seconds:"youtube"===_this.state.currentMediaType&&(5===_this.state.currentYouTubePlayer.getPlayerState()?(_this.videoResetTime(),_this.onYouTubePlayerReady()):_this.state.currentYouTubePlayer.seekTo(seconds,!0))},_this.videoResetTime=function(){"video"!==_this.state.currentMediaType&&"video-360"!==_this.state.currentMediaType||_this.videoJumpTo(0),_this.els.controlsVideoTimer.innerHTML="00:00",_this.els.controlsVideoProgressBar.setAttribute("value",0),_this.els.controlsVideoProgressBar.value=0,_this.els.controlsVideoProgressBar.style.setProperty("--val",0)},_this.loadSlide=function(mediaIndex,track){if(_this.updateStateBasedOnMediaTypeBeforeSlideChange(track),_this.state.currentMediaIndex=mediaIndex,_this.state.currentMediaEl=_this.els.slidesMediaULLIs[_this.state.currentMediaIndex],_this.state.currentMediaSetMediaItem=_this.state.currentMediaSetMedia[_this.state.currentMediaIndex],_this.state.currentMediaType=_this.state.currentMediaSetMediaItem.type,_this.els.recommendations&&"recommendations"===_this.state.currentMediaType){for(_this.els.slidesCounter.classList.add("me-hide"),i=0;i<_this.state.recommendations.source.length;i++)if(_this.state.recommendations.source[i].onSeen&&_this.state.recommendations.source[i].onClick){var thisOnSeen=JSON.parse(_this.state.recommendations.source[i].onSeen),thisOnClick=JSON.parse(_this.state.recommendations.source[i].onClick);thisOnSeen.recommendations[0].group&&thisOnClick.recommendations[0].group&&(thisOnSeen.recommendations[0].group="Media_Rec",thisOnClick.recommendations[0].group="Media_Rec",_this.state.recommendations.source[i].onSeen=JSON.stringify(thisOnSeen),_this.state.recommendations.source[i].onClick=JSON.stringify(thisOnClick)),_this.state.seenRecommendation=thisOnSeen,_this.analyticsTrack("recommendationSeen")}}else _this.els.slidesCounter.classList.remove("me-hide");_this.updateSlidesPosition(),_this.updateSlidesControlStates(),_this.updateSlidesCounter(),_this.config.slides.timeline&&(_this.state.currentTimelineBar=_this.els.slidesTimelineBars[_this.state.currentMediaIndex],_this._updateTimelineBars()),_this.highlightActiveMedia(),_this.reset360(),_this.shareUpdateLinks(),_this.updateStateBasedOnMediaTypeAfterSlideChange(track),_this.state.thumbnailsEnabled&&(_this.highlightActiveThumbnail(),_this.updateThumbnailsPosition(),_this.config.thumbnails.controls&&_this.updateThumbnailsControlStates()),!0===_this.config.recommendations&&mediaIndex==_this.state.currentMediaSetMedia.length-1&&_this.els.container.querySelector(".me-media-recommendations").focus(),_this.state.touch.supported||_this._preventTabbingToInactiveVideoPlayPauseOverlays(),_this.calculateWidths()},_this.loadSlideWithSrc=function(source){var matchedMediaIndex=0;for(var i in _this.state.currentMediaSetMedia){var currentMedia=_this.state.currentMediaSetMedia[i];if(source&&(currentMedia.source===source||-1!==source.indexOf(currentMedia.source)||currentMedia.sourceFullscreen===source||-1!==source.indexOf(currentMedia.sourceFullscreen))){matchedMediaIndex=parseInt(i);break}}_this.loadSlide(matchedMediaIndex)},_this.loadSlidePrevious=function(e,forceFocus){0!==_this.state.currentMediaIndex?_this.loadSlide(_this.state.currentMediaIndex-1,!0):_this.config.slides.loop?(_this.resetThumbnailControls(),_this.loadSlide(_this.state.currentMediaSetMedia.length-1,!0)):_this.state.touch.supported&&_this.cancelSwipe(),forceFocus&&_this.els.thumbnailsULLIs[_this.state.currentMediaIndex].querySelector("button").focus()},_this.loadSlideNext=function(e,forceFocus){_this.state.currentMediaIndex!==_this.state.currentMediaSetTotalMedia-1?_this.loadSlide(_this.state.currentMediaIndex+1,!0):_this.config.slides.loop?(_this.resetThumbnailControls(),_this.loadSlide(0,!0)):_this.state.touch.supported&&_this.cancelSwipe(),forceFocus&&_this.els.thumbnailsULLIs[_this.state.currentMediaIndex].querySelector("button").focus()},_this.queueLoadSlideNext=function(){_this.state.slideshowPlaying&&(_this.state.slideshowId=window.setTimeout(_this.loadSlideNext,_this.config.slides.displayTime))},_this.slideshowInit=function(){_this.config.slides.autoplay&&(_this.state.slideshowPlaying=!0)},_this.slideshowPlayPause=function(){_this.state.slideshowPlaying?(_this.state.slideshowPlaying=!1,_this.els.controlsGeneralSlideshowPlayPause.classList.remove("me-playing"),_this.state.slideshowId&&window.clearTimeout(_this.state.slideshowId)):(_this.state.slideshowPlaying=!0,_this.els.controlsGeneralSlideshowPlayPause.classList.add("me-playing"),_this.queueLoadSlideNext())},_this.calculateWidths=function(){var containerWidth=Math.ceil(parseFloat(window.getComputedStyle(_this.els.container.querySelector(".me-spacing")).width)),containerHeight=0,thumbnailsWidth=0;_this.state.thumbnailsEnabled&&(thumbnailsWidth=Math.ceil(parseFloat(window.getComputedStyle(_this.els.thumbnails).width)),_this.els.thumbnailsULLIs[0].removeAttribute("style"),_this.state.thumbnailsWidth=thumbnailsWidth,"manual"===_this.config.thumbnails.maxVisible?(_this.state.thumbnailWidth=parseInt(window.getComputedStyle(_this.els.thumbnailsULLIs[0]).width),_this.state.thumbnailsMaxVisible=_this.state.thumbnailsWidth/_this.state.thumbnailWidth):(_this.state.thumbnailWidth=_this.state.thumbnailsWidth/_this.config.thumbnails.maxVisible,_this.state.thumbnailsMaxVisible=_this.config.thumbnails.maxVisible),_this.state.totalThumbnailPages=Math.ceil(_this.state.currentMediaSetTotalMedia/_this.state.thumbnailsMaxVisible),_this.state.thumbnailsULWidth=_this.state.thumbnailWidth*_this.state.currentMediaSetTotalMedia,_this.els.thumbnailsUL.style.width=Math.ceil(_this.state.thumbnailsULWidth)+"px",_this.els.thumbnailsULLIs.forEach(function(el){el.style.width=thumbnailsWidth/_this.state.thumbnailsMaxVisible+"px"}),_this.updateThumbnailsPosition()),_this.state.width=containerWidth,_this.els.slidesMediaUL.style.width=containerWidth*_this.state.currentMediaSetTotalMedia+"px",_this.els.slidesMediaULLIs.forEach(function(el){el.style.width=containerWidth+"px"}),_this.updateSlidesPosition(),window.setTimeout(function(){containerHeight=parseInt(window.getComputedStyle(_this.els.container.querySelector(".me-spacing")).height),_this.state.height=containerHeight},100)},_this.updateSlidesPosition=function(){_this.els.slidesMediaUL.style.left=_this.state.currentMediaIndex*_this.state.width*-1+"px"},_this.updateSlidesControlStates=function(){var previousDisabled=0===_this.state.currentMediaIndex&&!_this.config.slides.loop,nextDisabled=_this.state.currentMediaIndex===_this.state.currentMediaSetTotalMedia-1&&!_this.config.slides.loop;_this.els.slidesControlPrevious.classList[previousDisabled?"add":"remove"]("me-disabled"),_this.els.slidesControlPrevious.setAttribute("aria-disabled",previousDisabled?"true":"false"),_this.els.slidesControlPrevious.setAttribute("tabindex",previousDisabled?"-1":"0"),_this.els.slidesControlNext.classList[nextDisabled?"add":"remove"]("me-disabled"),_this.els.slidesControlNext.setAttribute("aria-disabled",nextDisabled?"true":"false"),_this.els.slidesControlNext.setAttribute("tabindex",nextDisabled?"-1":"0")},_this.updateSlidesCounter=function(){_this.els.slidesCounterCurrent.innerText=_this.state.currentMediaIndex+1,_this.els.slidesCounterTotal.innerText=_this.state.currentMediaSetTotalMedia},_this.getLazyLoadedClasses=function(media){var lazyLoadedClasses="";return media.lazyLoaded&&(lazyLoadedClasses+="me-lazy-loaded "),media.lazyLoadedFullscreen&&(lazyLoadedClasses+="me-lazy-loaded-fullscreen "),lazyLoadedClasses},_this.fullscreenMediaSourceSwitchType=function(mediaType,mediaItem){return mediaItem.sourceFullscreen&&("image"===mediaType||"image-360"===mediaType||"video"===mediaType||"video-360"===mediaType||"cinemagraph"===mediaType)},_this.lazyLoadableType=function(mediaType){return"image"===mediaType||"image-360"===mediaType||"video"===mediaType||"video-360"===mediaType||"cinemagraph"===mediaType},_this.shouldLazyLoad=function(media){return _this.config.slides.lazyLoad&&(!_this.state.fullscreen&&!media.lazyLoaded||_this.state.fullscreen&&!media.sourceFullscreen&&!media.lazyLoaded||_this.state.fullscreen&&media.sourceFullscreen&&!media.lazyLoadedFullscreen)},_this.lazyLoad=function(){var mediaEl=_this.state.currentMediaEl.querySelector("img, video");(_this.state.fullscreen||_this.state.fullscreenEntering)&&mediaEl.getAttribute("data-src-fs")?(mediaEl.setAttribute("src",mediaEl.getAttribute("data-src-fs")),mediaEl.classList.add("me-lazy-loaded-fullscreen"),_this.state.currentMediaSetMediaItem.lazyLoadedFullscreen=!0):(mediaEl.setAttribute("src",mediaEl.getAttribute("data-src")),mediaEl.classList.add("me-lazy-loaded"),_this.state.currentMediaSetMediaItem.lazyLoaded=!0)},_this.updateStateBasedOnMediaTypeBeforeSlideChange=function(track){switch(_this.state.slideshowId&&window.clearTimeout(_this.state.slideshowId),_this.state.currentMediaType){case"image":case"image-360":_this.els.container.classList.remove("me-active-image"),_this.els.container.classList.remove("me-active-image-ratio-square"),"image"===_this.state.currentMediaType?_this.els.container.classList.remove("me-active-image"):"image-360"===_this.state.currentMediaType&&(_this.els.container.classList.remove("me-active-image-360"),_this.reset360());break;case"video":case"video-360":_this.videoPause(),_this.videoResetTime(),_this.unbindVideoEventListeners(),_this.config.video.autoplay,_this.state.currentMediaElVideo=null,_this.state.currentMediaElVideoPlayPauseOverlay=null,_this.clearCC(),_this.clearDT(),"video"===_this.state.currentMediaType?_this.els.container.classList.remove("me-active-video"):"video-360"===_this.state.currentMediaType&&(_this.els.container.classList.remove("me-active-video-360"),_this.reset360());break;case"youtube":_this.els.container.classList.remove("me-active-youtube"),_this.videoResetTime(),_this.unbindYouTubeEventListeners();break;case"cinemagraph":_this.els.container.classList.remove("me-active-cinemagraph");break;case"recommendations":_this.els.container.classList.remove("me-active-recommendations")}},_this.updateStateBasedOnMediaTypeAfterSlideChange=function(track){switch(_this.state.currentMediaType){case"image":case"image-360":_this.els.container.classList.add("me-active-image"),_this.state.currentMediaEl.classList.contains("me-ratio-square")&&_this.els.container.classList.add("me-active-image-ratio-square"),_this.els.controlsVideo.classList.add("me-hide"),_this.queueLoadSlideNext(),"image"===_this.state.currentMediaType?(_this.els.container.classList.add("me-active-image"),_this.els.controls360.classList.add("me-hide")):"image-360"===_this.state.currentMediaType&&(_this.els.container.classList.add("me-active-image-360"),_this.els.controls360.classList.remove("me-hide"),_this.init360());break;case"video":case"video-360":_this.els.controlsVideo.classList.remove("me-hide"),_this.state.currentMediaElVideo=_this.state.currentMediaEl.querySelector("video"),_this.state.currentMediaElVideoPlayPauseOverlay=_this.state.currentMediaEl.querySelector(".me-video-play-pause-overlay"),_this.loadCCFile(),_this.loadDT(),_this.bindVideoEventListeners(),_this.videoProgressBarSetDuration(),_this.videoVolumeSetLevelBars(),_this.videoVolumeApplyToCurrentVideo(),_this.config.video.autoplay&&_this.videoPlay(),_this.config.video.loop&&!_this.state.recommendations.length&&_this.videoLoop(),"video"===_this.state.currentMediaType?(_this.els.container.classList.add("me-active-video"),_this.els.controls360.classList.add("me-hide")):"video-360"===_this.state.currentMediaType&&(_this.els.container.classList.add("me-active-video-360"),_this.els.controls360.classList.remove("me-hide"),_this.init360());break;case"youtube":_this.els.container.classList.add("me-active-youtube"),_this.els.controlsVideo.classList.remove("me-hide"),_this.state.currentMediaElYouTubePlayPauseOverlay=_this.state.currentMediaEl.querySelector(".me-youtube-play-pause-overlay"),_this.bindYouTubeEventListeners();break;case"cinemagraph":_this.els.container.classList.add("me-active-cinemagraph"),_this.els.controlsVideo.classList.add("me-hide"),_this.queueLoadSlideNext();break;case"recommendations":_this.els.container.classList.add("me-active-recommendations"),_this.els.controlsVideo.classList.add("me-hide");break;case"countdown":_this.els.container.classList.add("me-active-countdown"),_this.els.controlsVideo.classList.add("me-hide"),_this.state.countdown&&!_this.state.countdown.initialized&&_this.countdownInit(),_this.queueLoadSlideNext();break;case"html":_this.els.container.classList.add("me-active-html"),_this.els.controlsVideo.classList.add("me-hide"),_this.queueLoadSlideNext()}_this.lazyLoadableType(_this.state.currentMediaType)&&_this.shouldLazyLoad(_this.state.currentMediaSetMediaItem)?_this.lazyLoad():_this.fullscreenMediaSourceSwitchType(_this.state.currentMediaType,_this.state.currentMediaSetMediaItem)&&_this.switchFullscreenMediaSource(),track&&"video"!==_this.state.currentMediaType&&"video-360"!==_this.state.currentMediaType&&_this.analyticsTrack("media")},_this.switchFullscreenMediaSource=function(){var mediaEl=_this.state.currentMediaEl.querySelector("img, video");(_this.state.fullscreen||_this.state.fullscreenEntering)&&mediaEl.getAttribute("data-src-fs")?mediaEl.setAttribute("src",mediaEl.getAttribute("data-src-fs")):mediaEl.setAttribute("src",mediaEl.getAttribute("data-src"))},_this.countdownInit=function(){_this.els.countdown=_this.els.container.querySelector(".me-media-countdown"),_this.state.countdown.interval=window.setInterval(_this.countdownUpdate,1e3),_this.state.countdown.initialized=!0,_this.countdownUpdate()},_this.countdownUpdate=function(){var t=_this.countdownGetTimeRemaining(),daysBlock=_this.els.countdown.querySelector(".days"),hoursBlock=_this.els.countdown.querySelector(".hours"),minutesBlock=_this.els.countdown.querySelector(".minutes"),secondsBlock=_this.els.countdown.querySelector(".seconds");daysBlock.innerHTML=t.days,hoursBlock.innerHTML=("0"+t.hours).slice(-2),minutesBlock.innerHTML=("0"+t.minutes).slice(-2),secondsBlock.innerHTML=("0"+t.seconds).slice(-2),t.total<=0&&(window.clearInterval(_this.state.countdown.interval),_this.els.countdown.querySelector(".time-blocks").classList.add("me-hide"),_this.els.countdown.querySelector(".time-expired").classList.remove("me-hide"),"function"==typeof _this.els.countdown.onExpire&&_this.els.countdown.onExpire())},_this.countdownGetTimeRemaining=function(){var t=Date.parse(_this.state.countdown.date)-Date.parse(new Date),seconds=Math.floor(t/1e3%60),minutes=Math.floor(t/1e3/60%60),hours=Math.floor(t/36e5%24);return{total:t,days:Math.floor(t/864e5),hours:hours,minutes:minutes,seconds:seconds}},_this.loadCCFile=function(){_this.state.currentMediaSetMediaItem.ccFileLoaded||(_this.state.currentMediaSetMediaItem.closedCaptioning?_this.loadCCXMLFile(_this.state.currentMediaSetMediaItem.closedCaptioning):_this.setCCError())},_this.setCCError=function(){_this.state.currentMediaSetMediaItem.closedCaptioning=[{beginTotalSeconds:0,endTotalSeconds:1e4,text:"Closed captioning is not available."}],_this.state.currentMediaSetMediaItem.ccFileLoaded=!0},_this.loadCCXMLFile=function(xmlPath){var xhr=new XMLHttpRequest;xhr.open("GET",xmlPath),xhr.send(null),xhr.onreadystatechange=function(){if(4===xhr.readyState)if(200===xhr.status)if(!_this.state.ie10Or11||xhr.responseXML&&xhr.responseXML.activeElement&&"object"==typeof xhr.responseXML.activeElement){for(var captionPs=(xhr.responseXML?xhr.responseXML:(new DOMParser).parseFromString(xhr.responseText,"text/xml")).querySelectorAll("p"),captions=[],i=0;i<captionPs.length;i++){var caption=captionPs[i],captionBeginParts=caption.getAttribute("begin").split(".")[0].split(":"),beginTotalSeconds=60*parseInt(captionBeginParts[1])+parseInt(captionBeginParts[2]),captionEndParts=caption.getAttribute("end").split(".")[0].split(":"),endTotalSeconds=60*parseInt(captionEndParts[1])+parseInt(captionEndParts[2]),textHTML=caption.innerHTML?caption.innerHTML:"";textHTML=textHTML.length&&"'"===textHTML[0]&&"'"===textHTML[textHTML.length-1]?textHTML.slice(1,-1):textHTML,captions.push({beginTotalSeconds:beginTotalSeconds,endTotalSeconds:endTotalSeconds,text:textHTML})}_this.state.currentMediaSetMediaItem.closedCaptioning=captions,_this.state.currentMediaSetMediaItem.ccFileLoaded=!0}else _this.setCCError();else _this.setCCError()}},_this.clearCC=function(){_this.updateCC("")},_this.updateCC=function(caption){_this.els.slidesCC.innerHTML=caption},_this.updateCCBasedOnVideoTime=function(totalSeconds){for(var captionsLength=_this.state.currentMediaSetMediaItem.closedCaptioning.length,showCaption=!1,i=0;i<captionsLength;i++){var caption=_this.state.currentMediaSetMediaItem.closedCaptioning[i];if(totalSeconds>=caption.beginTotalSeconds&&totalSeconds<=caption.endTotalSeconds){showCaption=!0,_this.updateCC(caption.text);break}}showCaption||_this.clearCC()},_this.loadDT=function(){_this.els.controlsVideoDT&&_this.state.currentMediaSetMediaItem.descriptiveTranscript&&(_this.els.controlsVideoDT.href=_this.state.currentMediaSetMediaItem.descriptiveTranscript)},_this.clearDT=function(){_this.els.controlsVideoDT&&_this.state.currentMediaSetMediaItem.descriptiveTranscript&&(_this.els.controlsVideoDT.href="")},_this.updateThumbnailsPosition=function(){_this.config.thumbnails.controls?_this.updateThumbnailsPage():_this.updateThumbnailsCentering()},_this.updateThumbnailsPage=function(){_this.els.thumbnailsUL.style.left=_this.state.currentThumbnailPage*_this.state.thumbnailsMaxVisible*_this.state.thumbnailWidth*-1+"px"},_this.updateThumbnailsCentering=function(){_this.state.currentMediaSetTotalMedia>_this.state.thumbnailsMaxVisible?_this.state.currentMediaIndex<Math.ceil(_this.state.thumbnailsMaxVisible/2)?_this.els.thumbnailsUL.style.left="0px":_this.state.currentMediaIndex>=_this.state.currentMediaSetTotalMedia-Math.ceil(_this.state.thumbnailsMaxVisible/2)?_this.els.thumbnailsUL.style.left=-1*(_this.state.thumbnailsULWidth-_this.state.thumbnailWidth*_this.state.thumbnailsMaxVisible)+"px":_this.els.thumbnailsUL.style.left=-1*(_this.state.currentMediaIndex*_this.state.thumbnailWidth-_this.state.thumbnailsWidth/2)-_this.state.thumbnailWidth/2+"px":_this.els.thumbnailsUL.style.left="0px"},_this.updateThumbnailsControlStates=function(){var previousDisabled=0===_this.state.currentThumbnailPage,nextDisabled=_this.state.currentThumbnailPage===_this.state.totalThumbnailPages-1;_this.els.thumbnailsControlPrevious.classList[previousDisabled?"add":"remove"]("me-disabled"),_this.els.thumbnailsControlPrevious.setAttribute("aria-disabled",previousDisabled?"true":"false"),_this.els.thumbnailsControlPrevious.setAttribute("tabindex",previousDisabled?"-1":"0"),_this.els.thumbnailsControlNext.classList[nextDisabled?"add":"remove"]("me-disabled"),_this.els.thumbnailsControlNext.setAttribute("aria-disabled",nextDisabled?"true":"false"),_this.els.thumbnailsControlNext.setAttribute("tabindex",nextDisabled?"-1":"0")},_this.resetThumbnailControls=function(){_this.config.thumbnails.controls&&(_this.state.currentThumbnailPage=0,_this.updateThumbnailsPage(),_this.updateThumbnailsControlStates())},_this.highlightActiveMedia=function(){var activeMediaLI=_this.els.slidesMediaULLIs[_this.state.currentMediaIndex];_this.els.slidesMediaULLIs.forEach(function(el){el.classList.remove("me-active"),el.setAttribute("aria-hidden","true")}),activeMediaLI.classList.add("me-active","me-has-been-active"),activeMediaLI.setAttribute("aria-hidden","false")},_this.highlightActiveThumbnail=function(){_this.els.thumbnailsULLIs.forEach(function(el){el.classList.remove("me-active"),el.setAttribute("aria-selected","false")}),_this.els.thumbnailsULLIs[_this.state.currentMediaIndex].classList.add("me-active","me-has-been-active"),_this.els.thumbnailsULLIs[_this.state.currentMediaIndex].setAttribute("aria-selected","true")},_this.highlightActiveTab=function(){_this.els.tabsAnchors.forEach(function(el){el.classList.remove("me-active"),el.setAttribute("aria-selected","false")}),_this.els.tabsAnchors[_this.state.currentMediaSetIndex].classList.add("me-active"),_this.els.tabsAnchors[_this.state.currentMediaSetIndex].setAttribute("aria-selected","true")},_this._preventTabbingToInactiveVideoPlayPauseOverlays=function(){_this.els.slidesMediaULLIs[_this.state.currentMediaIndex];var activeVideoPlayPauseOverlay=_this._getCurrentVideoPlayPauseOverlay();_this.els.slidesMediaULLIs.forEach(function(el){var playPauseOverlay=el.querySelector(".me-video-play-pause-overlay, .me-youtube-play-pause-overlay");playPauseOverlay&&playPauseOverlay.setAttribute("tabindex","-1")}),activeVideoPlayPauseOverlay&&activeVideoPlayPauseOverlay.removeAttribute("tabindex")},_this._getCurrentVideoPlayPauseOverlay=function(){return _this.state.currentMediaElVideoPlayPauseOverlay||_this.state.currentMediaElYouTubePlayPauseOverlay},_this.analyticsInit=function(){_this.config.iframed?(console.log("Analytics framework to be loaded by parent frame."),_this.analyticsSetDefaultPageModel()):window.WDPRO&&window.WDPRO.Analytics&&window.WDPRO.Analytics.Framework&&window.WDPRO.Analytics.Framework.trackElement&&window.WDPRO.Analytics.Framework.baseModelPromise&&window.WDPRO.Analytics.Framework.baseModelProcessed?(_this.state.analytics.frameworkLoaded=!0,console.log("Analytics framework initializing..."),window.WDPRO.Analytics.Framework.baseModelPromise.then(function(pageModel){console.log("Analytics framework model loaded."),_this.state.analytics.pageModel=pageModel},function(e){console.log("Error loading analytics framework model. Using default data."),_this.analyticsSetDefaultPageModel()})):(_this.state.analytics.frameworkLoadAttempts+=1,_this.state.analytics.frameworkLoadAttempts<=3?(console.log("Analytics framework not ready, attempting initialization again..."),window.setTimeout(_this.analyticsInit,1300)):4===_this.state.analytics.frameworkLoadAttempts&&console.log("Error initializing analytics."))},_this.analyticsSetDefaultPageModel=function(){_this.state.analytics.pageModel={pageId:ME3.prototype.defaults.analytics.tracking.pageId,site:ME3.prototype.defaults.analytics.tracking.site}},_this.analyticsPageModelLoaded=function(){return _this.state.analytics.pageModel&&0!==Object.keys(_this.state.analytics.pageModel).length},_this.analyticsTrack=function(trigger){if(_this.analyticsShouldTrack(trigger)&&_this.analyticsPageModelLoaded()&&(_this.state.analytics.frameworkLoaded||_this.config.iframed)){var trackingObject={},mediaSrc=_this.state.currentMediaSetMediaItem.source,mediaType={image:"pic",video:"vid","image-360":"360","video-360":"360",cinemagraph:"cinemagraph"}[_this.state.currentMediaType],filename=mediaSrc.split("/").pop().split("?")[0].replace(/\.(mp4|webm|jpg|png|gif)/,""),linkId=_this.state.analytics.pageModel.site+"_MP_"+_this.state.analytics.pageModel.pageId.replace(/\s/,"")+"_"+filename+"_",videoTrackingPrevious=(trackingObject={},{filename:filename,linkId:linkId,mediaType:mediaType}),videoEvent=!1;switch(trigger){case"baidu":trackingObject={linkId:linkId+"ShareModal_Baidu",mediaId:filename,socialInteractionType:"baidu",trackingType:"customLink"};break;case"closedCaptionOn":trackingObject={linkId:linkId+"ClosedCaption_On",mediaId:filename,trackingType:"customLink"};break;case"closedCaptionOff":trackingObject={linkId:linkId+"ClosedCaption_Off",mediaId:filename,trackingType:"customLink"};break;case"email":trackingObject={linkId:linkId+"ShareModal_Email",mediaId:filename,socialInteractionType:"email",trackingType:"customLink"};break;case"facebook":trackingObject={linkId:linkId+"ShareModal_Facebook",mediaId:filename,socialInteractionType:"facebook",trackingType:"customLink"};break;case"media":trackingObject={linkId:linkId+"Media",mediaId:filename,events:"assetStart",mediaType:mediaType,trackingType:"customLink"};break;case"muteOn":trackingObject={linkId:linkId+"Mute_On",mediaId:filename,trackingType:"customLink"};break;case"muteOff":trackingObject={linkId:linkId+"Mute_Off",mediaId:filename,trackingType:"customLink"};break;case"pinterest":trackingObject={linkId:linkId+"ShareModal_Pinterest",mediaId:filename,socialInteractionType:"pinterest",trackingType:"customLink"};break;case"share":trackingObject={linkId:linkId+"ShareButton",mediaId:filename,trackingType:"customLink"};break;case"twitter":trackingObject={linkId:linkId+"ShareModal_Twitter",mediaId:filename,socialInteractionType:"twitter",trackingType:"customLink"};break;case"videoStart":videoEvent=!0,videoTrackingPrevious={filename:filename,linkId:linkId,mediaType:mediaType},trackingObject={linkId:linkId+"VideoStart",mediaId:filename,events:"videoStart",mediaType:mediaType,trackingType:"customLink"};break;case"videoPause":videoEvent=!0,trackingObject={linkId:linkId+"VideoPause",mediaId:filename,events:"videoPause",mediaType:mediaType,trackingType:"customLink"};break;case"videoView":videoEvent=!0,trackingObject={linkId:linkId+"VideoView",mediaId:filename,events:"videoView",mediaType:mediaType,trackingType:"customLink"};break;case"videoPct25":case"videoPct50":case"videoPct75":videoEvent=!0,trackingObject={linkId:linkId+"VideoViewPercent",mediaId:filename,events:trigger,mediaType:mediaType,trackingType:"customLink"};break;case"videoStop":videoEvent=!0,trackingObject={linkId:linkId+"VideoStop",mediaId:filename,events:"videoStop",mediaType:mediaType,trackingType:"customLink"};break;case"videoClose":videoEvent=!0,videoTrackingPrevious&&(filename=videoTrackingPrevious.filename,linkId=videoTrackingPrevious.linkId,mediaType=videoTrackingPrevious.mediaType),trackingObject={linkId:linkId+"VideoClose",mediaId:filename,events:"videoClose",mediaType:mediaType,trackingType:"customLink"};break;case"weibo":trackingObject={linkId:linkId+"ShareModal_Weibo",mediaId:filename,socialInteractionType:"weibo",trackingType:"customLink"};break;case"recommendationShowOrNo":var recDialup=localStorage.getItem("recsDialup").split("-");trackingObject={dialupPhase:recDialup[0],dialupGroup:recDialup[1]}}videoEvent&&_this.state.currentMediaElVideo&&(trackingObject.events=[trackingObject.events,{videoTime:Math.round(_this.state.currentMediaElVideo.currentTime)||0}]),"recommendationSeen"===trigger?window.WDPRO.Analytics.Framework.trackElement(_this.state.seenRecommendation.linkId,_this.state.seenRecommendation):"recommendationInteraction"===trigger?window.WDPRO.Analytics.Framework.trackElement(_this.state.clickedRecommendation.linkId,_this.state.clickedRecommendation):_this.config.iframed?(console.log("ME DEBUG: analyticsTrack postMessage *",trackingObject),window.parent.postMessage(trackingObject,"*")):window.WDPRO.Analytics.Framework.trackElement(trackingObject)}else 4!==_this.state.analytics.frameworkLoadAttempts&&(_this.state.analytics.trackAttempts+=1,_this.state.analytics.trackAttempts<=3?(console.log("Analytics framework not ready, waiting to track again..."),window.setTimeout(function(){_this.analyticsTrack(trigger)},1300)):4===_this.state.analytics.trackAttempts&&console.log("Error waiting for analytics framework to track."))},_this.analyticsShouldTrack=function(trigger){return-1===["videoStart","videoView","videoPct25","videoPct50","videoPct75","videoStop"].indexOf(trigger)||(_this.state.currentMediaElVideo?!_this.state.currentMediaElVideo.getAttributeNS(null,"data-tracked-"+trigger)&&(_this.state.currentMediaElVideo.setAttributeNS(null,"data-tracked-"+trigger,"true"),!0):void 0)},_this.analyticsTrackOnceReset=function(trigger){_this.state.currentMediaElVideo&&_this.state.currentMediaElVideo.removeAttributeNS(null,"data-tracked-"+trigger)},_this.recommend=function(input){input!=_this.state.recommendations.source&&(_this.state.recommendations.source=input),(_this.state.mediaSets[0].media[_this.state.mediaSets[0].media.length-1].type="recommendations")&&(_this.recommendationsInit(),window.dispatchEvent(new CustomEvent("me-recommendation-updated",{detail:input,bubbles:!0})))},_this.recommendationsInit=function(init){_this.state.recommendations={type:"recommendations",thumbnail:"",source:[],title:"Recommendations",tags:["Disney Photos"],alt:""},window.addEventListener("gavChanged",_this._setUpRecommendation),window.addEventListener("me-recommendation-updated",function(evt){window.removeEventListener("gavChanged",_this._setUpRecommendation(evt))})},_this._setUpRecommendation=function(evt){var defaultRecommendations=evt?evt.detail:_this.state.recommendations.source,displayCount=defaultRecommendations.length;_this.state.recommendations.source=[];for(var i=0;i<displayCount;i++)defaultRecommendations[i]&&_this.state.recommendations.source.push(defaultRecommendations[i]);_this._loadRecommendations()},_this.hotLinkInit=function(){var hotLinkMediaPieces,hotLinkMedia=ME3.prototype.utilities.url.getQueryString("media");if(hotLinkMedia&&(hotLinkMediaPieces="string"==typeof hotLinkMedia?hotLinkMedia.split("/"):[])[0]&&!isNaN(hotLinkMediaPieces[0])&&hotLinkMediaPieces[1]&&!isNaN(hotLinkMediaPieces[1])){var mediaSet=parseInt(hotLinkMediaPieces[0],10),mediaIndex=parseInt(hotLinkMediaPieces[1],10);_this.state.mediaSets[mediaSet]&&_this.state.mediaSets[mediaSet].media[mediaIndex]&&_this.state.mediaSets[mediaSet].media[mediaIndex].source&&(console.log("Hotlinking to: "+_this.state.mediaSets[mediaSet].media[mediaIndex].source),_this.loadSlideWithSrc(_this.state.mediaSets[mediaSet].media[mediaIndex].source))}}},ME3.prototype={defaults:{accessibility:{labels:{en:{meTitle:"Media Engine",slidesControlPrevious:"Load previous slide",slidesControlNext:"Load next slide",controlsVideoPlayPause:"Play/pause video",controlsVideoVolumeMute:"Mute/unmute video",controlsVideoVolumeLevel1:"Set volume level 1",controlsVideoVolumeLevel2:"Set volume level 2",controlsVideoVolumeLevel3:"Set volume level 3",controlsVideoVolumeLevel4:"Set volume level 4",controlsVideoVolumeLevel5:"Set volume level 5",controlsVideoCC:"Enable/disable closed captioning",controlsVideoDT:"Access descriptive transcript",controlsGeneralSlideshowPlayPause:"Play/pause slideshow",controlsGeneralShareToggle:"Share media",controlsGeneralFullscreen:"Enter/exit fullscreen",thumbnailsControlPrevious:"Load previous thumbnails set",thumbnailsControlNext:"Load next thumbnails set",fullscreenExit:"Exit fullscreen",exitGav:"Exit recommendations",countdownText:"Next slide will play in 30 seconds"},es:{meTitle:"Motor de Medios",slidesControlPrevious:"Cargar diapositiva anterior",slidesControlNext:"Cargar la siguiente diapositiva",controlsVideoPlayPause:"Reproducir/pausar video",controlsVideoVolumeMute:"Silenciar/activar video",controlsVideoVolumeLevel1:"Establecer nivel de volumen 1",controlsVideoVolumeLevel2:"Establecer nivel de volumen 2",controlsVideoVolumeLevel3:"Establecer nivel de volumen 3",controlsVideoVolumeLevel4:"Establecer nivel de volumen 4",controlsVideoVolumeLevel5:"Establecer nivel de volumen 5",controlsVideoCC:"Habilitar/deshabilitar subtítulos",controlsVideoDT:"Acceder a la transcripción descriptiva",controlsGeneralSlideshowPlayPause:"Reproducir/pausar presentación de diapositivas",controlsGeneralShareToggle:"Compartir medios",controlsGeneralFullscreen:"Entrar/salir de pantalla completa",thumbnailsControlPrevious:"Cargar conjunto de miniaturas anteriores",thumbnailsControlNext:"Cargar el siguiente set de miniaturas",fullscreenExit:"Salir de pantalla completa",exitGav:"Salir",countdownText:"La próxima diapositiva se reproducirá en 30 segundos"}}},analytics:{labels:{slidesControlPrevious:"PreviousSlideButton",slidesControlNext:"NextSlideButton",controlsVideoPlayPausePlay:"PlayButton",controlsVideoPlayPausePause:"PauseButton",controlsVideoCCOn:"ClosedCaption_On",controlsVideoCCOff:"ClosedCaption_Off",controlsGeneralShareToggle:"ShareButton",controlsGeneralShareLinkFacebook:"ShareModal_Facebook",controlsGeneralShareLinkPinterest:"ShareModal_Pinterest",controlsGeneralShareLinkTumblr:"ShareModal_Tumblr",controlsGeneralShareLinkTwitter:"ShareModal_Twitter",controlsGeneralShareLinkWhatsApp:"ShareModal_WhatsApp"},tracking:{pageId:"[DEFAULT_PAGEID]",site:"[DEFAULT_SITE]",vendor:"[DEFAULT_VENDOR]"}},callbacks:{ready:null,customFullscreenEnter:null,customFullscreenExit:null},layout:["tabs","slides","controls","thumbnails"],tabs:{customHTML:{before:"",prepend:"",append:"",after:""},initial:0,showTotals:!0,sort:function(a,b){return a>b?1:-1}},slides:{autoplay:!0,customHTML:{before:"",prepend:"",append:"",after:""},displayTime:5e3,fullscreenAPIEnabled:!1,fullscreenOnTouchOrClick:!1,lazyLoad:!1,loop:!0,timeline:!1,transitionTime:300},controls:{customHTML:{before:"",prepend:"",append:"",after:""},general:{shareLinks:[]},threeSixty:{layout:["pan","zoom"]},video:{layout:["progress-bar","play-pause","timer","volume","cc","dt"]}},idleTime:3e3,iframed:!1,recommendationsIdleTime:50,countdownTimeLeft:0,imageGAVCounter:0,downloadTimer:0,smallScreenCurrentRecsEnd:2,currentRecsEnd:0,thumbnails:{controls:!0,customHTML:{before:"",prepend:"",append:"",after:""},maxVisible:"manual",minWidth:768,previewOnHover:!1,transitionTime:300},video:{autoplay:!1,loop:-1===window.location.href.indexOf("tickets-visit-guide"),muted:!1,unmuteOnFullscreen:!1},recommendations:!1,exitedGav:!1,mobile:768,desktop:1024},utilities:{extend:function(first,second){for(var secondProp in second){var secondVal=second[secondProp];secondVal&&"[object Object]"===Object.prototype.toString.call(secondVal)?(first[secondProp]=first[secondProp]||{},ME3.prototype.utilities.extend(first[secondProp],secondVal)):secondVal&&"[object Array]"===Object.prototype.toString.call(secondVal)?first[secondProp]=ME3.prototype.utilities.extend([],secondVal.slice()):first[secondProp]=secondVal}return first},url:{getQueryString:function(name){var match=new RegExp("[?&]"+name+"=([^&]*)").exec(window.location.search);return match&&decodeURIComponent(match[1].replace(/\+/g," "))},getURLProtocol:function(){return"file:"===window.location.protocol?"http:":window.location.protocol}},storage:{localStorageIsSupported:function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}}},version:"3.0.178"},ME=new ME3;